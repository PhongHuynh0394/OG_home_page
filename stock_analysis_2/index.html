

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title>Stock Analysis P2 - OG Page</title><meta name="Description" content="OG page"><meta property="og:title" content="Stock Analysis P2" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://phonghuynh.netlify.app/stock_analysis_2/" /><meta property="og:image" content="https://phonghuynh.netlify.app/img/projects-stock.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-05T23:15:54+07:00" />
<meta property="article:modified_time" content="2023-09-05T23:15:54+07:00" /><meta property="og:site_name" content="OG Page" />
<meta property="og:see_also" content="https://phonghuynh.netlify.app/stock_analysis/" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://phonghuynh.netlify.app/img/projects-stock.jpg"/>

<meta name="twitter:title" content="Stock Analysis P2"/>
<meta name="twitter:description" content=""/>
<meta name="application-name" content="OG">
<meta name="apple-mobile-web-app-title" content="OG">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://phonghuynh.netlify.app/stock_analysis_2/" /><link rel="prev" href="https://phonghuynh.netlify.app/stock_analysis/" /><link rel="next" href="https://phonghuynh.netlify.app/spotify_analysis/" />
<link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/color.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/fontawesome-free/all.min.css">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/animate/animate.min.css">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Stock Analysis P2",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/phonghuynh.netlify.app\/stock_analysis_2\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/phonghuynh.netlify.app\/img\/oggy.png",
                            "width":  240 ,
                            "height":  240 
                        }],"genre": "posts","keywords": "Machine learning, math","wordcount":  4603 ,
        "url": "https:\/\/phonghuynh.netlify.app\/stock_analysis_2\/","datePublished": "2023-09-05T23:15:54+07:00","dateModified": "2023-09-05T23:15:54+07:00","publisher": {
            "@type": "Organization",
            "name": "OG Page","logo": "https:\/\/phonghuynh.netlify.app\/favicon.icon"},"authors": [{
                        "@type": "Person",
                        "name": "OG"                    
                    }],"description": ""
    }
    </script><script src="//instant.page/5.2.0" defer type="module" integrity="sha384-jnZyxPjiipYXnSU0ygqeac2q7CVYMbh84q0uHVRRxEtvFPiQYbXWUorga2aqZJ0z"></script>
</head>

<body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">
        function setTheme(theme) {document.body.setAttribute('theme', theme); document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark'); window.theme = theme;   window.isDark = window.theme !== 'light' }
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('auto' === 'light' || 'auto' === 'dark' || 'auto' === 'black') setTheme('auto'), saveTheme('auto'); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let metaColors = {'light': '#f8f8f8','dark': '#252627','black': '#000000'}
        getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
        window.switchThemeEventSet = new Set()
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="OG Page"><img
        class="logo"
        loading="lazy"
        src="/favicon.ico"
        srcset="/favicon.ico, /favicon.ico 1.5x, /favicon.ico 2x"
        sizes="auto"
        alt="/favicon.ico"
        title="/favicon.ico" >OG Page</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/blogs/" title="OG&#39;s blogs"> Blogs </a><a class="menu-item" href="/tags/" title="Tags of blogs"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/projects/"> Projects </a><a class="menu-item" href="/about/"> About </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="OG Page"><img
        class="logo"
        loading="lazy"
        src="/favicon.ico"
        srcset="/favicon.ico, /favicon.ico 1.5x, /favicon.ico 2x"
        sizes="auto"
        alt="/favicon.ico"
        title="/favicon.ico" >OG Page</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/blogs/" title="OG&#39;s blogs">Blogs</a><a class="menu-item" href="/tags/" title="Tags of blogs">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/projects/" title="">Projects</a><a class="menu-item" href="/about/" title="">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
            <div class="container"><div class="toc" id="toc-auto">
        <h2 class="toc-title">Contents</h2>
        <div class="toc-content always-active" id="toc-content-auto"><nav id="TableOfContents">
  <ul>
    <li><a href="#k-means-clustering">K-Means Clustering</a>
      <ul>
        <li><a href="#k-means-step-by-step">K-Means step by step</a></li>
        <li><a href="#the-k-means-algorithm-is-written-in-object-oriented-form">The K-means algorithm is written in object-oriented form</a></li>
        <li><a href="#finding-the-optimal-k-in-a-k-means-clustering">Finding the optimal &lsquo;K&rsquo; in a K-Means clustering</a></li>
        <li><a href="#evaluation-metrics-of-k-means-clustering">Evaluation Metrics of K-Means Clustering</a></li>
        <li><a href="#visualize">Visualize</a></li>
      </ul>
    </li>
    <li><a href="#data-analysis">Data Analysis</a>
      <ul>
        <li><a href="#analytical-overview">Analytical Overview</a></li>
        <li><a href="#cluster-b">Cluster B</a>
          <ul>
            <li><a href="#bi·∫øn-ƒë·ªông-th·ªã-tr∆∞·ªùng">Bi·∫øn ƒë·ªông th·ªã tr∆∞·ªùng</a></li>
            <li><a href="#c√°c-s·ª±-ki·ªán-·∫£nh-h∆∞·ªüng">C√°c s·ª± ki·ªán ·∫£nh h∆∞·ªüng</a></li>
            <li><a href="#k·∫øt-lu·∫≠n-xu-h∆∞·ªõng">K·∫øt lu·∫≠n xu h∆∞·ªõng</a></li>
          </ul>
        </li>
        <li><a href="#cluster-a">Cluster A</a>
          <ul>
            <li><a href="#bi·∫øn-ƒë·ªông-th·ªã-tr∆∞·ªùng-1">Bi·∫øn ƒë·ªông th·ªã tr∆∞·ªùng</a></li>
            <li><a href="#s·ª±-ki·ªán-·∫£nh-h∆∞·ªüng">S·ª± ki·ªán ·∫£nh h∆∞·ªüng</a></li>
            <li><a href="#k·∫øt-lu·∫≠n-xu-h∆∞·ªõng-1">K·∫øt lu·∫≠n xu h∆∞·ªõng</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#k·∫øt-th√∫c">K·∫øt th√∫c</a></li>
  </ul>
</nav></div>
    </div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Stock Analysis P2</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><span class='author'><span class="author fas fa-user-circle fa-fw"></span><span class='screen-reader-text'>  </span><a href='https://phonghuynh.netlify.app/authors/og'>OG</a></span>
                </span>&nbsp;<span class="post-category">included in </span>&nbsp;<span class="post-series">series <a href="/series/stock-analysis/"><i class="far fa-list-alt fa-fw"></i>Stock Analysis</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="05 Sep 2023">05 Sep 2023</time>&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;22 minutes&nbsp;</div>
        </div><div class="details series-nav open">
                                <div class="details-summary series-title">
                                    <span>Series - Stock Analysis</span>
                                    <span><i class="details-icon fas fa-angle-right"></i></span>
                                </div>
                                <div class="details-content series-content">
                                    <nav>
                                        <ul>
                                                    <li><a href="/stock_analysis/">Stock analysis</a></li><li><span class="active">Stock Analysis P2</span></li></ul>
                                    </nav>
                                </div>
                            </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#k-means-clustering">K-Means Clustering</a>
      <ul>
        <li><a href="#k-means-step-by-step">K-Means step by step</a></li>
        <li><a href="#the-k-means-algorithm-is-written-in-object-oriented-form">The K-means algorithm is written in object-oriented form</a></li>
        <li><a href="#finding-the-optimal-k-in-a-k-means-clustering">Finding the optimal &lsquo;K&rsquo; in a K-Means clustering</a></li>
        <li><a href="#evaluation-metrics-of-k-means-clustering">Evaluation Metrics of K-Means Clustering</a></li>
        <li><a href="#visualize">Visualize</a></li>
      </ul>
    </li>
    <li><a href="#data-analysis">Data Analysis</a>
      <ul>
        <li><a href="#analytical-overview">Analytical Overview</a></li>
        <li><a href="#cluster-b">Cluster B</a>
          <ul>
            <li><a href="#bi·∫øn-ƒë·ªông-th·ªã-tr∆∞·ªùng">Bi·∫øn ƒë·ªông th·ªã tr∆∞·ªùng</a></li>
            <li><a href="#c√°c-s·ª±-ki·ªán-·∫£nh-h∆∞·ªüng">C√°c s·ª± ki·ªán ·∫£nh h∆∞·ªüng</a></li>
            <li><a href="#k·∫øt-lu·∫≠n-xu-h∆∞·ªõng">K·∫øt lu·∫≠n xu h∆∞·ªõng</a></li>
          </ul>
        </li>
        <li><a href="#cluster-a">Cluster A</a>
          <ul>
            <li><a href="#bi·∫øn-ƒë·ªông-th·ªã-tr∆∞·ªùng-1">Bi·∫øn ƒë·ªông th·ªã tr∆∞·ªùng</a></li>
            <li><a href="#s·ª±-ki·ªán-·∫£nh-h∆∞·ªüng">S·ª± ki·ªán ·∫£nh h∆∞·ªüng</a></li>
            <li><a href="#k·∫øt-lu·∫≠n-xu-h∆∞·ªõng-1">K·∫øt lu·∫≠n xu h∆∞·ªõng</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#k·∫øt-th√∫c">K·∫øt th√∫c</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><div class="details admonition warning open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-exclamation-triangle fa-fw"></i>Warning<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">ƒê√¢y l√† ki·∫øn th·ª©c t√≠ch g√≥p t·ª´ nhi·ªÅu ngu·ªìn v√† t√¨m hi·ªÉu c·ªßa nh√≥m OG, t·∫•t nhi√™n kh√¥ng th·ªÉ tr√°nh kh·ªèi sai s√≥t.
Hy v·ªçng b√†i vi·∫øt l·∫ßn n√†y th√∫ v·ªã v√† gi√∫p b·∫°n ƒë·ªçc th∆∞ gi√£n, tham kh·∫£o.</div>
        </div>
    </div>
<a target="_blank" href="https://github.com/PhongHuynh0394/Stock-Analysis" title="PhongHuynh0394" class="friend-link" rel="noopener noreferrer">
    <div class="friend-link-div">
        <div class="friend-link-avatar"><img
        
        loading="lazy"
        src="/img/github-logo.png"
        srcset="/img/github-logo.png, /img/github-logo.png 1.5x, /img/github-logo.png 2x"
        sizes="auto"
        alt="/img/github-logo.png"
        title="/img/github-logo.png" height="560"   width="560" ></div>
        <div class="friend-link-info">
            <div class="friend-name-div">
                <i class="fas fa-user-circle fa-fw"></i>
                <i class="friend-name">PhongHuynh0394</i>
            </div>
            <p class="friend-bio">Stock-Analysis</p>
        </div>
    </div>
</a>
<p>H√© l√¥ h√© l√¥ l√† OG ƒë√¢yy, ·ªü ph·∫ßn 1, ta ƒë√£ gi·∫£m chi·ªÅu d·ªØ li·ªáu b·∫±ng PCA r·ªìi, ti·∫øp ƒë·∫øn ph·∫ßn n√†y, ch√∫ng ta s·∫Ω d√πng K-means ƒë·ªÉ ph√¢n c·ª•m r·ªìi t√¨m ra ƒëi·ªÉm
chung c·ªßa d·ªØ li·ªáu nh√©, cu·ªëi c√πng l√† ph√¢n t√≠ch c√°c &ldquo;s·ª± ki·ªán&rdquo; ƒë√£ di·ªÖn ra trong t·ª´ng c·ª•m. L√©t g√¥ !</p>
<p>M·ªôt l·∫ßn n·ªØa xin c·∫£m ∆°n th·∫ßy Nguy·ªÖn Ho√†ng ƒê·ª©c v√† th·∫ßy Ng√¥ Minh M·∫´n ƒë√£ h·ªó tr·ª£ ƒë·ªÉ ƒë·ªì √°n ƒë∆∞·ª£c ho√†n thi·ªán. ƒê·ªìng th·ªùi c·∫£m ∆°n c√°c th√†nh vi√™n nh√≥m 7
ƒë√£ c√πng l√†m vi·ªác h·∫øt m√¨nh.</p>
<h2 id="k-means-clustering" class="headerLink">
    <a href="#k-means-clustering" class="header-mark"></a>K-Means Clustering</h2><p>Nh·∫Øc l·∫°i ch√∫t x√≠u, ·ªü <a href="/stock_analysis/" rel="">Ph·∫ßn 1</a> ch√∫ng ta ƒë√£ d√πng PCA l√†m gi·∫£m chi·ªÅu d·ªØ li·ªáu nh∆∞ng x√©t v·ªÅ m·∫∑t √Ω nghƒ©a, d·ªØ li·ªáu sau PCA ch∆∞a
th·ªÉ ph√¢n t√≠ch ƒë∆∞·ª£c m√† ta s·∫Ω ch·ªâ d√πng n√≥ ƒë·ªÉ √°p v√†o m·ªôt k·ªπ thu·∫≠t ti·∫øp theo. K·ªπ thu·∫≠t n√†y s·∫Ω &ldquo;g·ªôp nh√≥m&rdquo; d·ªØ li·ªáu v√† tr·∫£ l·ªùi c√¢u h·ªèi &ldquo;<strong>l√†m th·ªÉ n√†o ƒë·ªÉ ph√¢n d·ªØ li·ªáu th√†nh c√°c c·ª•m (cluster) kh√°c nhau, sao cho d·ªØ li·ªáu trong c√πng m·ªôt c·ª•m c√≥ t√≠nh ch·∫•t gi·ªëng nhau?</strong>&rdquo;</p>
<p>B·∫£n ch·∫•t c·ªßa vi·ªác ph√¢n nh√≥m n√†y d·ª±a tr√™n nh·ªØng bi·∫øn ƒë·ªông, s·ª± ki·ªán n√†o ƒë√≥ tr√™n th·ªã tr∆∞·ªùng m√† ch√∫ng ta ch∆∞a bi·∫øt nh∆∞ng n√≥ chi ph·ªëi tr·ª±c ti·∫øp hay gi√°n ti·∫øp, nhi·ªÅu hay √≠t ƒë·∫øn v·ªõi c√°c c·ªï phi·∫øu c√≥ li√™n quan.
Ch√≠nh v√¨ l√Ω do ƒë√≥, ch√∫ng ta ti·∫øn h√†nh s·ª≠ d·ª•ng thu·∫≠t to√°n K-Means Clustering ƒë·ªÉ ph√¢n c·ª•m d·ªØ li·ªáu ph·ª•c v·ª• m·ª•c ti√™u ƒë·ªÅ ra.</p>
<p>Trong b√†i n√†y ch√∫ng ta s·∫Ω th·ª±c hi·ªán thu·∫≠t K-means <code>step by step</code>, n√†o b·∫Øt ƒë·∫ßu thoaii üòÑ</p>
<h3 id="k-means-step-by-step" class="headerLink">
    <a href="#k-means-step-by-step" class="header-mark"></a>K-Means step by step</h3><p><strong>Step 1: L·ª±a ch·ªçn s·ªë clusters $K$</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># initialize labels</span>
<span class="n">N</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">X_pca</span><span class="o">.</span><span class="n">shape</span>
<span class="n">pre_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Hyper-parameters</span>
<span class="n">K_CLUSTERS</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># &lt;&lt; N</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Step 2: Ch·ªçn K ƒëi·ªÉm ng·∫´u nhi√™n t·ª´ d·ªØ li·ªáu l√†m tr·ªçng t√¢m</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">random</span>
<span class="c1"># random K-samples to be centroids</span>
<span class="n">k_indices</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">K_CLUSTERS</span><span class="p">)</span>
<span class="n">centroids</span> <span class="o">=</span> <span class="n">X_pca</span><span class="p">[</span><span class="n">k_indices</span><span class="p">]</span>    <span class="c1"># shape: (K, d)</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Step 3: G√°n t·∫•t c·∫£ c√°c ƒëi·ªÉm cho t√¢m c·ª•m g·∫ßn nh·∫•t</strong></p>
<p>H√†m <code>assign_cluster()</code> gi√∫p ta ph√¢n m·ªói ƒëi·ªÉm d·ªØ li·ªáu v√†o cluster c√≥ center g·∫ßn n√≥ nh·∫•t v·ªõi K ƒëi·ªÉm b·∫•t k·ª≥ ƒë∆∞·ª£c ch·ªçn l√†m c√°c center ban ƒë·∫ßu</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">assign_cluster</span><span class="p">(</span><span class="n">distances</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="c1"># distances: (N, K)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># return min value from distances array</span>
</code></pre></td></tr></table>
</div>
</div><p>C·ª• th·ªÉ:</p>
<ul>
<li>M·∫£ng <strong>distances</strong> ch·ª©a kho·∫£ng c√°ch t·ª´ ƒëi·ªÉm $i$ ƒë·∫øn c·ª•m $k$, ƒë√¢y l√† kho·∫£ng c√°ch Euclid v·ªõi c√¥ng th·ª©c distance$(x,y)=||x-y||$</li>
<li>H√†m <strong>np.argmin()</strong> tr·∫£ v·ªÅ gi√° tr·ªã c·ªßa bi·∫øn s·ªë ƒë·ªÉ h√†m s·ªë ƒë√≥ ƒë·∫°t gi√° tr·ªã nh·ªè nh·∫•t. N√≥i c√°ch kh√°c, n√≥ gi√∫p ch√∫ng ta t√¨m ra ƒë∆∞·ª£c v·ªã tr√≠ m√† ƒëi·ªÉm d·ªØ li·ªáu ph·∫£i thu·ªôc v·ªÅ d·ª±a tr√™n quy t·∫Øc g·∫ßn c·ª•m n√†o nh·∫•t th√¨ ch·ªçn c·ª•m ƒë√≥. V√≠ d·ª•:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Example for np.argmin()</span>
       <span class="c1"># k =   0  1  2</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>   <span class="c1"># min = 0 and it locate in 1 -&gt; x_1 y_1 = 1</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span> <span class="c1"># min =-1 and it locate in 0 -&gt; x_2 y_2 = 0</span>

<span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># --&gt; array([1,0])</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Step 4: T√≠nh to√°n l·∫°i c√°c tr·ªçng t√¢m c·ªßa c√°c c·ª•m m·ªõi ƒë∆∞·ª£c h√¨nh th√†nh</strong>
H√†m <strong>update_centroids()</strong> d√πng c·∫≠p nh·∫≠t l·∫°i t√¢m c·ª•m v√† tr·∫£ v·ªÅ 1 b·ªô c√°c t√¢m c·ª•m m·ªõi b·∫±ng c√°ch l·∫•y trung b√¨nh c·ªông c·ªßa t·∫•t c√°c c√°c ƒëi·ªÉm d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c g√°n v√†o cluster ƒë√≥.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">update_centroids</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">new_centroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K_CLUSTERS</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">new_centroids</span> <span class="c1"># (3, 13)</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Cu·ªëi c√πng: l·∫∑p l·∫°i step 3 v√† step 4</strong>
<div class="details admonition question open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-question-circle fa-fw"></i>Question<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p><strong>Khi n√†o th√¨ b√†i to√°n h·ªôi t·ª• v·∫≠y OG ? Khi n√†o th√¨ ch√∫ng ta m·ªõi d·ª´ng l·∫°i thu·∫≠t to√°n ?</strong></p>
<p>&ndash;&gt; C√¢u tr·∫£ l·ªùi l√† khi vi·ªác ph√¢n c·ª•m kh√¥ng c√≤n s·ª± thay ƒë·ªïi n√†o n·ªØa ho·∫∑c gi√° tr·ªã <em>h√†m m·∫•t m√°t</em> kh√¥ng thay ƒë·ªïi nhi·ªÅu sau m·ªói l·∫ßn update t√¢m c·ª•m.</p>
</div>
        </div>
    </div>
Ch√∫ng ta s·∫Ω vi·∫øt m·ªôt h√†m ki·ªÉm tra t√≠nh h·ªôi t·ª• c·ªßa b√†i to√°n l√† <strong>has_convert()</strong>. H√†m n√†y ki·ªÉm tra c·ª•m tr∆∞·ªõc v√† sau c√≥ gi·ªëng nhau kh√¥ng.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Check convergence</span>
<span class="k">def</span> <span class="nf">has_convert</span><span class="p">(</span><span class="n">pre_labels</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">cur_labels</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span> 
    <span class="k">return</span> <span class="p">(</span><span class="n">pre_labels</span> <span class="o">==</span> <span class="n">cur_labels</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>H√†m <strong>get_total_wcv()</strong> l√† m·ªôt h√†m m·∫•t m√°t, t√≠nh t·ªïng c√°c ph∆∞∆°ng sai b√™n trong c·ªßa 1 cluster</p>
<p>N·∫øu ta coi $m_k$ l√† center (representation) c·ªßa m·ªói cluster v√† ∆∞·ªõc l∆∞·ª£ng t·∫•t c·∫£ c√°c ƒëi·ªÉm ƒë∆∞·ª£c ph√¢n v√†o cluster n√†y b·ªüi $m_k$, th√¨
m·ªôt ƒëi·ªÉm d·ªØ li·ªáu $x_i$ ƒë∆∞·ª£c ph√¢n v√†o cluster $k$ s·∫Ω b·ªã sai s·ªë l√† $(x_i-m_k)$. Ch√∫ng ta mong mu·ªën sai s·ªë n√†y c√≥ tr·ªã tuy·ªát ƒë·ªëi b√© nh·∫•t n√™n ta s·∫Ω t√¨m
c√°ch ƒë·ªÉ ƒë·∫°i l∆∞·ª£ng sau ƒë√¢y ƒë·∫°t min: $||x_i - m_k||^2_2$</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">get_total_wcv</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">centroids</span><span class="p">):</span>
    <span class="c1"># Total within cluster variance </span>
    <span class="n">WCVs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> \
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K_CLUSTERS</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">WCVs</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Nh√¨n chung v·ªÅ ƒëi·ªÅu ki·ªán h·ªôi t·ª• c√≥ th·ªÉ th·∫•y m·ªëi li√™n h·ªá gi·ªØa c√°c ƒëi·ªÅu ki·ªán l√† g·∫ßn t∆∞∆°ng ƒë·ªìng nh∆∞ nhau.
Khi c√≥ √≠t ƒëi·ªÉm d·ªØ li·ªáu ƒë∆∞·ª£c g√°n sang cluster kh√°c c√≥ th·ªÉ khi·∫øn ƒëi·ªÉm trung t√¢m kh√¥ng thay ƒë·ªïi nhi·ªÅu v√† t·ª´ ƒë√≥ h√†m m·∫•t m√°t c≈©ng s·∫Ω √≠t b·ªã ·∫£nh h∆∞·ªüng.</p>
<h3 id="the-k-means-algorithm-is-written-in-object-oriented-form" class="headerLink">
    <a href="#the-k-means-algorithm-is-written-in-object-oriented-form" class="header-mark"></a>The K-means algorithm is written in object-oriented form</h3><p>Ta s·∫Ω k·∫øt h·ª£p t·∫•t c·∫£ c√°c b∆∞·ªõc thu·∫≠t to√°n v√†o m·ªôt ƒë·ªëi t∆∞·ª£ng <code>KMeansClustering</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">distance</span>

<span class="k">class</span> <span class="nc">KMeansClustering</span><span class="p">:</span>
    <span class="s2">&#34;&#34;&#34;
</span><span class="s2">        An instance of K-Means Clustering algorithm
</span><span class="s2">    &#34;&#34;&#34;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">29</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;
</span><span class="s2">            n_clusters: number of clusters
</span><span class="s2">            _centroids: center/ centroid of clusters
</span><span class="s2">            inertia_: sum of squared distances of samples to their closest cluster center
</span><span class="s2">            labels_: labels of input samples
</span><span class="s2">            X: input data
</span><span class="s2">        &#34;&#34;&#34;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">n_clusters</span>
    
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
      <span class="s2">&#34;&#34;&#34;
</span><span class="s2">          K-means execution
</span><span class="s2">      &#34;&#34;&#34;</span>
      <span class="n">N</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>

      <span class="c1"># random K-samples to be centroids</span>
      <span class="n">k_indices</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_centroids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">k_indices</span><span class="p">]</span>

      <span class="c1"># initialize labels</span>
      <span class="n">pre_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

      <span class="c1"># training</span>
      <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
          <span class="c1"># compute distances from X_i to</span>
          <span class="n">distances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_dists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_centroids</span><span class="p">)</span>
          <span class="c1"># assign new labels</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">labels_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assign_cluster</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>  <span class="c1"># assign new labels</span>
          <span class="c1"># check convergence</span>
          <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_convert</span><span class="p">(</span><span class="n">pre_labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_</span><span class="p">):</span>
              <span class="k">break</span>
          <span class="c1"># update centroids</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">_update_centroids</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
          <span class="n">pre_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_</span>
          <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>

      <span class="c1"># compute total Within Cluster Variance (WCV)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">inertia_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_total_WCV</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_centroids</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_dists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">distance</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="s2">&#34;euclidean&#34;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_assign_cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distances</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_centroids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_centroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="n">X</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">)]</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_calc_total_WCV</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">centroids</span><span class="p">):</span>
        <span class="n">WCVs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroids</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">WCVs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_has_convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pre_labels</span><span class="p">,</span> <span class="n">cur_labels</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">pre_labels</span> <span class="o">==</span> <span class="n">cur_labels</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_test</span><span class="p">):</span>
        <span class="n">dist_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_dists</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_centroids</span><span class="p">)</span>
        <span class="n">test_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assign_cluster</span><span class="p">(</span><span class="n">dist_test</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">test_labels</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_test</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Tr∆∞·ªõc khi th·∫≠t s·ª± √°p d·ª•ng thu·∫≠t to√°n n√†y cho dataset c·ªßa ch√∫ng ta, c√≥ m·ªôt c√¢u h·ªèi ƒë·∫∑t ra l√†: <strong>Thu·∫≠t to√°n n√†y th·ª±c hi·ªán v·ªõi ƒë·∫ßu v√†o
l√† s·ªë $K$ t·ª©c l√† s·ªë l∆∞·ª£ng cluster, th·∫ø th√¨ $K$ b·∫±ng bao nhi√™u l√† t·ªët nh·∫•t?</strong></p>
<h3 id="finding-the-optimal-k-in-a-k-means-clustering" class="headerLink">
    <a href="#finding-the-optimal-k-in-a-k-means-clustering" class="header-mark"></a>Finding the optimal &lsquo;K&rsquo; in a K-Means clustering</h3><p>C√≥ m·ªôt ph∆∞∆°ng ph√°p t√™n l√† <code>Elbow</code> aka c√°i khu·ª∑a tay üòÑ</p>
<p>Ph∆∞∆°ng ph√°p <code>Elbow</code> l√† m·ªôt c√°ch gi√∫p ta l·ª±a ch·ªçn ƒë∆∞·ª£c s·ªë l∆∞·ª£ng c√°c c·ª•m ph√π h·ª£p d·ª±a v√†o ƒë·ªì th·ªã tr·ª±c quan ho√° b·∫±ng c√°ch nh√¨n v√†o s·ª± suy gi·∫£m c·ªßa h√†m bi·∫øn d·∫°ng v√† l·ª±a ch·ªçn ra ƒëi·ªÉm khu·ª∑u tay (elbow point).</p>
<p>ƒê·ªëi v·ªõi m·ªói gi√° tr·ªã c·ªßa $K$, ta t√≠nh to√°n <strong>WCSS (T·ªïng b√¨nh ph∆∞∆°ng trong c·ª•m)</strong>. WCSS l√† t·ªïng b√¨nh ph∆∞∆°ng kho·∫£ng c√°ch gi·ªØa m·ªói ƒëi·ªÉm v√† t√¢m trong m·ªôt c·ª•m.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">elbow_method</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k_clusters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">))):</span>
    <span class="n">total_wcss</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">k_clusters</span><span class="p">:</span>
        <span class="c1"># Train with k cluster</span>
        <span class="n">kmeans_model</span> <span class="o">=</span> <span class="n">KMeansClustering</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
        <span class="n">kmeans_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

        <span class="c1"># calculate WCSS</span>
        <span class="n">total_wcss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kmeans_model</span><span class="o">.</span><span class="n">inertia_</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_clusters</span><span class="p">,</span> <span class="n">total_wcss</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;WCSS&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of clusters K&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">elbow_method</span><span class="p">(</span><span class="n">X_pca</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Khi ta v·∫Ω ƒë·ªì th·ªã WCSS v·ªõi gi√° tr·ªã K, ƒë·ªì th·ªã tr√¥ng gi·ªëng nh∆∞ m·ªôt khu·ª∑u tay. Khi s·ªë c·ª•m tƒÉng l√™n, gi√° tr·ªã WCSS s·∫Ω b·∫Øt ƒë·∫ßu gi·∫£m. Gi√° tr·ªã WCSS l·ªõn nh·∫•t khi $K=1$</p>
<figure><a class="lightgallery" href="https://media.discordapp.net/attachments/1155749221677400085/1155749659281727489/stock-elbow.png?width=800&amp;height=625" title="elbow_method" data-thumbnail="https://media.discordapp.net/attachments/1155749221677400085/1155749659281727489/stock-elbow.png?width=800&amp;height=625" data-sub-html="<h2>Gi√° tr·ªã WCSS l·ªõn nh·∫•t khi $K=1$</h2><p>elbow_method</p>">
        <img
            
            loading="lazy"
            src="https://media.discordapp.net/attachments/1155749221677400085/1155749659281727489/stock-elbow.png?width=800&amp;height=625"
            srcset="https://media.discordapp.net/attachments/1155749221677400085/1155749659281727489/stock-elbow.png?width=800&amp;height=625, https://media.discordapp.net/attachments/1155749221677400085/1155749659281727489/stock-elbow.png?width=800&amp;height=625 1.5x, https://media.discordapp.net/attachments/1155749221677400085/1155749659281727489/stock-elbow.png?width=800&amp;height=625 2x"
            sizes="auto"
            alt="elbow_method" height="500"  width="800" >
    </a><figcaption class="image-caption">Gi√° tr·ªã WCSS l·ªõn nh·∫•t khi $K=1$</figcaption>
    </figure>
<p>Ch√∫ng ta c√≥ th·ªÉ th·∫•y r·∫±ng bi·ªÉu ƒë·ªì s·∫Ω thay ƒë·ªïi nhanh ch√≥ng t·∫°i $K=2$ v√† do ƒë√≥ t·∫°o ra h√¨nh d·∫°ng khu·ª∑u tay. T·ª´ th·ªùi ƒëi·ªÉm n√†y, ƒë·ªì th·ªã di chuy·ªÉn g·∫ßn nh∆∞ song song v·ªõi tr·ª•c $X$</p>
<p>Gi√° tr·ªã $K$ t∆∞∆°ng ·ª©ng v·ªõi ƒëi·ªÉm n√†y l√† gi√° tr·ªã t·ªëi ∆∞u c·ªßa $K$ ho·∫∑c c·ª•m t·ªëi ∆∞u.</p>
<h3 id="evaluation-metrics-of-k-means-clustering" class="headerLink">
    <a href="#evaluation-metrics-of-k-means-clustering" class="header-mark"></a>Evaluation Metrics of K-Means Clustering</h3><p><code>Silhouette Score</code>: cho ch√∫ng ta bi·∫øt nh·ªØng ƒëi·ªÉm d·ªØ li·ªáu hay nh·ªØng quan s√°t n√†o n·∫±m g·ªçn b√™n trong c·ª•m (t·ªët) hay n·∫±m g·∫ßn ngo√†i r√¨a c·ª•m (kh√¥ng t·ªët) ƒë·ªÉ ƒë√°nh gi√° hi·ªáu qu·∫£ ph√¢n c·ª•m.</p>
<p>Gi·∫£ s·ª≠ c√≥ 2 cluster A, B th√¨ Silhouette score l√†:
$$ s_i = \frac{(b_i - a_i)}{max(b_i - a_i)} $$</p>
<p>V·ªõi $a_i, b_i$ l·∫ßn l∆∞·ª£t l√† kho·∫£ng c√°ch c·ªßa ƒëi·ªÉ $i$ ƒë·∫øn t√¢m c·ª•m A v√† B</p>
<p>Gi√° tr·ªã n√†y n·∫±m trong kho·∫£ng [-1, 1]:</p>
<ul>
<li>ƒêi·ªÉm d·ªØ li·ªáu c√≥ Silhouette cao, g·∫ßn b·∫±ng 1: n·∫±m ƒë√∫ng trong cluster.</li>
<li>ƒêi·ªÉm d·ªØ li·ªáu c√≥ Silhouette g·∫ßn b·∫±ng 0: n·∫±m gi·ªØa 2 cluster</li>
<li>ƒêi·ªÉm d·ªØ li·ªáu c√≥ Silhouette th·∫•p, c√≥ gi√° tr·ªã √¢m: th√¨ kh·∫£ nƒÉng ƒë√£ n·∫±m sai cluster.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="n">kmeans_train</span> <span class="o">=</span> <span class="n">KMeansClustering</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">kmeans_train</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_pca</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">kmeans_train</span><span class="o">.</span><span class="n">labels_</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Silhouette Score (n = 2): </span><span class="si">{</span><span class="n">metrics</span><span class="o">.</span><span class="n">silhouette_score</span><span class="p">(</span><span class="n">X_pca</span><span class="p">,</span><span class="n">labels</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1">#--&gt; Silhouette Score (n = 2): 0.265365408366845</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">kmeans_train</span> <span class="o">=</span> <span class="n">KMeansClustering</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">kmeans_train</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_pca</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">kmeans_train</span><span class="o">.</span><span class="n">labels_</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Silhouette Score (n = 3): </span><span class="si">{</span><span class="n">metrics</span><span class="o">.</span><span class="n">silhouette_score</span><span class="p">(</span><span class="n">X_pca</span><span class="p">,</span><span class="n">labels</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># --&gt; Silhouette Score (n = 3): 0.22528216696570613</span>
</code></pre></td></tr></table>
</div>
</div><p>·ªû Ph∆∞∆°ng ph√°p Elbow, ch√∫ng ta c≈©ng ƒë√£ th·∫•y ƒë∆∞·ª£c $K$ t·ªëi ∆∞u cho b√†i to√°n ch√≠nh l√† khi ch·ªçn $K=2$.
Nh∆∞ng ·ªü b∆∞·ªõc n√†y, ta c≈©ng th·∫•y ƒë∆∞·ª£c r√µ r√†ng h∆°n gi·ªØa 2 s·ª± l·ª±a ch·ªçn $K=2$ v√† $K=3$  b·∫±ng c√°ch so s√°nh ch·ªâ s·ªë Silhouette gi·ªØa b·ªçn ch√∫ng.</p>
<p>So s√°nh: $0.265(K=2) &gt; 0.225(K=3)$</p>
<p>T·ª´ ƒë√≥, m·ªôt l·∫ßn n·ªØa ta th·∫•y ƒë∆∞·ª£c $K$ t·ªëi ∆∞u nh·∫•t cho b√†i to√°n n√†y l√† $K=2$</p>
<h3 id="visualize" class="headerLink">
    <a href="#visualize" class="header-mark"></a>Visualize</h3><p>Sau t·∫•t c·∫£ c√°c b∆∞·ªõc tr√™n, d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c chia th√†nh 2 label ch√≠nh t∆∞∆°ng ·ª©ng v·ªõi t·ª´ng m√†u s·∫Øc ƒë∆∞·ª£c bi·ªÉu th·ªã d∆∞·ªõi h√¨nh v·∫Ω sau ƒë√¢y:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># K means</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>

<span class="n">K_CLUSTERS</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">kmeans_train</span> <span class="o">=</span> <span class="n">KMeansClustering</span><span class="p">(</span><span class="n">K_CLUSTERS</span><span class="p">)</span>
<span class="n">kmeans_train</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_pca</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span>
    <span class="n">X_pca</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">pca_scree</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="n">kmeans_train</span><span class="o">.</span><span class="n">labels_</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">diagonal_visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><figure><a class="lightgallery" href="https://cdn.discordapp.com/attachments/1155749221677400085/1155757661774688316/stock-kmean-viual.png" title="Kmeans Clustering" data-thumbnail="https://cdn.discordapp.com/attachments/1155749221677400085/1155757661774688316/stock-kmean-viual.png" data-sub-html="<h2>K-means cluster with 2 Clusters and various PC</h2><p>Kmeans Clustering</p>">
        <img
            
            loading="lazy"
            src="https://cdn.discordapp.com/attachments/1155749221677400085/1155757661774688316/stock-kmean-viual.png"
            srcset="https://cdn.discordapp.com/attachments/1155749221677400085/1155757661774688316/stock-kmean-viual.png, https://cdn.discordapp.com/attachments/1155749221677400085/1155757661774688316/stock-kmean-viual.png 1.5x, https://cdn.discordapp.com/attachments/1155749221677400085/1155757661774688316/stock-kmean-viual.png 2x"
            sizes="auto"
            alt="Kmeans Clustering" width="900" >
    </a><figcaption class="image-caption">K-means cluster with 2 Clusters and various PC</figcaption>
    </figure>
<p>Sau khi chia c·ª•m, ch√∫ng ta ƒë·∫øn v·ªõi b∆∞·ªõc cu·ªëi c√πng th√¥i</p>
<h2 id="data-analysis" class="headerLink">
    <a href="#data-analysis" class="header-mark"></a>Data Analysis</h2><p>Sau khi K-means, ta c√≥ ƒë∆∞·ª£c m·ªôt t·∫≠p nh√£n (labels), ta s·∫Ω g√°n c√°c nh√£n n√†y v√†o b·ªô data c√≥ gi√° tr·ªã v√† ti·∫øn h√†nh ph√¢n t√≠ch t·ª´ng c·ª•m.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Data</span>
<span class="c1">#set label</span>
<span class="n">value_data</span> <span class="o">=</span> <span class="n">new_market</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans_train</span><span class="o">.</span><span class="n">labels_</span>
<span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># get specific columns</span>
<span class="n">gtb</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">value_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;gttb_&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">]</span>
<span class="n">mua</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">value_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;total_mua&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">]</span>
<span class="n">ban</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">value_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;total_ban&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">]</span>

<span class="c1"># create new valuabel column</span>
<span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;total_ban_30&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_data</span><span class="p">[</span><span class="n">ban</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;total_mua_30&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_data</span><span class="p">[</span><span class="n">mua</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;total_volume_30&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;total_ban_30&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;total_mua_30&#39;</span><span class="p">]</span>
<span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;mua_ban_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;total_mua_30&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;total_ban_30&#39;</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>value_data bao g·ªìm c√°c c·ªôt:</p>
<ul>
<li>label: nh√£n nh·∫≠n ƒë∆∞·ª£c t·ª´ K means (g·ªìm &lsquo;A&rsquo; v√† &lsquo;B&rsquo;)</li>
<li>gttb_{m√£}: Trung b√¨nh gi√° c·ªßa m·ªôt {m√£} c·ªï phi·∫øu</li>
<li>total_mua_{m√£}: T·ªïng kh·ªëi l∆∞·ª£ng mua c·ªßa {m√£} c·ªï phi·∫øu</li>
<li>total_ban_{m√£}: T·ªïng kh·ªëi l∆∞·ª£ng b√°n c·ªßa {m√£} c·ªï phi·∫øu</li>
<li>total_mua_30: T·ªïng kh·ªëi l∆∞·ª£ng mua c·ªßa t·∫•t c·∫£ 30 c·ªï phi·∫øu</li>
<li>total_ban_30: T·ªïng kh·ªëi l∆∞·ª£ng b√°n c·ªßa t·∫•t c·∫£ 30 c·ªï phi·∫øu</li>
<li>total_volume_30: T·ªïng kh·ªëi l∆∞·ª£ng giao d·ªãch c·ªßa 30 c·ªï phi·∫øu (total_mua_30 + total_ban_30)</li>
<li>mua_ban_ratio: t·ªâ s·ªë total_mua_30 / total_ban_30</li>
<li>Gia KL: Gi√° ph√°i sinh g·∫ßn v·ªõi VN30</li>
</ul>
<p>Time-series Data theo ph√∫t (5154 d√≤ng)</p>
<h3 id="analytical-overview" class="headerLink">
    <a href="#analytical-overview" class="header-mark"></a>Analytical Overview</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">from</span> <span class="nn">plotly.subplots</span> <span class="kn">import</span> <span class="n">make_subplots</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">vertical_spacing</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>

<span class="c1"># plot A</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">value_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span> 
                     <span class="n">y</span><span class="o">=</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;total_volume_30&#39;</span><span class="p">][</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">]),</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">value_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span> 
                         <span class="n">y</span><span class="o">=</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;Gia KL&#39;</span><span class="p">][</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span> 
                         <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">),</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="c1"># plot B</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">value_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> 
                     <span class="n">y</span><span class="o">=</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;total_volume_30&#39;</span><span class="p">][</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">]),</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">value_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> 
                         <span class="n">y</span><span class="o">=</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;Gia KL&#39;</span><span class="p">][</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> 
                         <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">),</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># update layout</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&#34;Stock Data Visualization&#34;</span><span class="p">,</span> <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">barmode</span><span class="o">=</span><span class="s1">&#39;stack&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&#34;Total Volume 30&#34;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&#34;Gia KL&#34;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&#34;Total Volume 30&#34;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&#34;Gia KL&#34;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="https://media.discordapp.net/attachments/1105503055916564572/1105552168716615804/Stock_Data_Visualization.png?width=831&amp;height=452" title="Stock Data Visualization" data-thumbnail="https://media.discordapp.net/attachments/1105503055916564572/1105552168716615804/Stock_Data_Visualization.png?width=831&amp;height=452" data-sub-html="<h2>Stock Data Visualization</h2><p>Stock Data Visualization</p>">
        <img
            
            loading="lazy"
            src="https://media.discordapp.net/attachments/1105503055916564572/1105552168716615804/Stock_Data_Visualization.png?width=831&amp;height=452"
            srcset="https://media.discordapp.net/attachments/1105503055916564572/1105552168716615804/Stock_Data_Visualization.png?width=831&amp;height=452, https://media.discordapp.net/attachments/1105503055916564572/1105552168716615804/Stock_Data_Visualization.png?width=831&amp;height=452 1.5x, https://media.discordapp.net/attachments/1105503055916564572/1105552168716615804/Stock_Data_Visualization.png?width=831&amp;height=452 2x"
            sizes="auto"
            alt="Stock Data Visualization" width="800" >
    </a><figcaption class="image-caption">Stock Data Visualization</figcaption>
    </figure>
Cluster B ch·ª©a c√°c d·ªØ li·ªáu trong giai ƒëo·∫°n t·ª´ <strong>20/3 ƒë·∫øn 6/4/2023</strong></p>
<p><strong>Nh√¨n nh·∫≠n m·ªôt c√°ch t·ªïng qu√°t:</strong></p>
<ul>
<li>ƒê·ªëi v·ªõi cluster B, th·ªã tr∆∞·ªùng lu√¥n trong th·∫ø &ldquo;gi·∫±ng co&rdquo; v·ªõi kho·∫£ng 6 ƒë·ª£t gi·∫£m m·∫°nh v√† ch·ª´ng ·∫•y ƒë·ª£t ph·ª•c h·ªìi li√™n t·ª•c trong su·ªët 18 ng√†y. M·∫∑c d√π GiaKL duy tr√¨ ƒë∆∞·ª£c ƒë√† tƒÉng (Gi√° KL t·ª´ 1036 tƒÉng ƒë·∫øn 1080) t·∫°o t√≠ch c·ª±c cho th·ªã tr∆∞·ªùng song th·∫ø gi·∫±ng co v·∫´n c√≥ chi·ªÅu h∆∞·ªõng k√©o d√†i.</li>
</ul>
<p>Cluster A ch·ª©a c√°c d·ªØ li·ªáu trong giai ƒëo·∫°n t·ª´ <strong>1/4 ƒë·∫øn 19/4/2023</strong>:</p>
<p><strong>Nh√¨n nh·∫≠n m·ªôt c√°ch t·ªïng qu√°t:</strong></p>
<ul>
<li>ƒê·ªëi v·ªõi cluster A c√°c kho·∫£ng gi·∫£m k√©o d√†i trong nhi·ªÅu ng√†y d·∫´n ƒë·∫øn vi·ªác ph·ª•c h·ªìi g·∫∑p kh√≥ khƒÉn ƒë√°ng k·ªÉ. C·ª• th·ªÉ, GiaKL c√≥ m·ª©c &ldquo;v√πng d·∫≠y&rdquo; ƒë·∫øn ng∆∞·ª°ng 1086 ƒëi·ªÉm t·∫°i 6/4 nh∆∞ng l·∫°i b·ªã ƒë·∫©y v·ªÅ 1054 v√†o cu·ªëi giai ƒëo·∫°n.</li>
</ul>
<p>Ta s·∫Ω ph√¢n t√≠ch s√¢u h∆°n t·ª´ng cluster m·ªôt</p>
<h3 id="cluster-b" class="headerLink">
    <a href="#cluster-b" class="header-mark"></a>Cluster B</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>

<span class="n">gtb</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">value_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;gttb_&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">value_data</span><span class="p">[</span><span class="n">gtb</span><span class="p">][</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">gtb</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mean Values by Label B&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&#34;Times&#34;</span><span class="p">,</span> <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&#34;Mean Values&#34;</span><span class="p">,</span>
<span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&#34;Courier New, monospace&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&#34;RebeccaPurple&#34;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><figure><a class="lightgallery" href="https://media.discordapp.net/attachments/1105503055916564572/1105552168993427626/Mean_Values_by_Label_B.png?width=807&amp;height=452" title="Mean Values by Label B" data-thumbnail="https://media.discordapp.net/attachments/1105503055916564572/1105552168993427626/Mean_Values_by_Label_B.png?width=807&amp;height=452" data-sub-html="<h2>Mean Values by Label B</h2><p>Mean Values by Label B</p>">
        <img
            
            loading="lazy"
            src="https://media.discordapp.net/attachments/1105503055916564572/1105552168993427626/Mean_Values_by_Label_B.png?width=807&amp;height=452"
            srcset="https://media.discordapp.net/attachments/1105503055916564572/1105552168993427626/Mean_Values_by_Label_B.png?width=807&amp;height=452, https://media.discordapp.net/attachments/1105503055916564572/1105552168993427626/Mean_Values_by_Label_B.png?width=807&amp;height=452 1.5x, https://media.discordapp.net/attachments/1105503055916564572/1105552168993427626/Mean_Values_by_Label_B.png?width=807&amp;height=452 2x"
            sizes="auto"
            alt="Mean Values by Label B" width="800" >
    </a><figcaption class="image-caption">Mean Values by Label B</figcaption>
    </figure>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>

<span class="c1"># Create first trace</span>
<span class="n">trace1</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;mua&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">value_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;total_ban_30&#39;</span><span class="p">][</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>

<span class="c1"># Create second trace</span>
<span class="n">trace2</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ban&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">value_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;total_mua_30&#39;</span><span class="p">][</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>

<span class="c1"># Create third trace</span>
<span class="n">trace3</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&#34;GiaKL&#34;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">value_data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;Gia KL&#39;</span><span class="p">][</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">=</span><span class="s1">&#39;y2&#39;</span><span class="p">)</span>

<span class="c1"># Create layout</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;The chart shows the correlation between Total Volumn and GiaKL&#39;</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Times&#39;</span><span class="p">),</span> <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Total Volumn&#39;</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">),</span> <span class="n">yaxis2</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Gia KL&#39;</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">overlaying</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">barmode</span><span class="o">=</span><span class="s2">&#34;stack&#34;</span><span class="p">)</span>

<span class="c1"># Add traces to figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">trace1</span><span class="p">,</span> <span class="n">trace2</span><span class="p">,</span> <span class="n">trace3</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>

<span class="c1"># Show figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><figure><a class="lightgallery" href="https://media.discordapp.net/attachments/1105503055916564572/1105552169840689152/correlation_between_Total_Volumn_and_GiaKL_B.png?width=831&amp;height=452" title="B-Correlation between Total Volumn and GiaKL" data-thumbnail="https://media.discordapp.net/attachments/1105503055916564572/1105552169840689152/correlation_between_Total_Volumn_and_GiaKL_B.png?width=831&amp;height=452" data-sub-html="<h2>B-Correlation between Total Volumn and GiaKL</h2><p>B-Correlation between Total Volumn and GiaKL</p>">
        <img
            
            loading="lazy"
            src="https://media.discordapp.net/attachments/1105503055916564572/1105552169840689152/correlation_between_Total_Volumn_and_GiaKL_B.png?width=831&amp;height=452"
            srcset="https://media.discordapp.net/attachments/1105503055916564572/1105552169840689152/correlation_between_Total_Volumn_and_GiaKL_B.png?width=831&amp;height=452, https://media.discordapp.net/attachments/1105503055916564572/1105552169840689152/correlation_between_Total_Volumn_and_GiaKL_B.png?width=831&amp;height=452 1.5x, https://media.discordapp.net/attachments/1105503055916564572/1105552169840689152/correlation_between_Total_Volumn_and_GiaKL_B.png?width=831&amp;height=452 2x"
            sizes="auto"
            alt="B-Correlation between Total Volumn and GiaKL" width="800" >
    </a><figcaption class="image-caption">B-Correlation between Total Volumn and GiaKL</figcaption>
    </figure>
<h4 id="bi·∫øn-ƒë·ªông-th·ªã-tr∆∞·ªùng" class="headerLink">
    <a href="#bi%e1%ba%bfn-%c4%91%e1%bb%99ng-th%e1%bb%8b-tr%c6%b0%e1%bb%9dng" class="header-mark"></a>Bi·∫øn ƒë·ªông th·ªã tr∆∞·ªùng</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">phantramtangtruong</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1081.55</span> <span class="o">-</span> <span class="mf">1014.331</span><span class="p">)</span><span class="o">/</span><span class="mf">1014.331</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Gia tri cua phien cao nhat so voi phien nho nhat: &#34;</span><span class="p">,</span><span class="n">phantramtangtruong</span><span class="p">)</span> <span class="c1"># --&gt; 0.06626929473712223</span>
</code></pre></td></tr></table>
</div>
</div><p>Giai ƒëo·∫°n n√†y cho th·∫•y s·ª± gia tƒÉng c·ªßa gi√° tr·ªã c√°c c·ªï phi·∫øu, v·ªõi s·ª©c tƒÉng l·ªõn nh·∫•t trong ng∆∞·ª°ng ti·ªám c·∫≠n 0.07%
cho th·∫•y s·ª± h·∫•p d·∫´n c·ªßa th·ªã tr∆∞·ªùng ƒëang tr√™n ƒë√† ph·ª•c h·ªìi.</p>
<p>V√†o cu·ªëi th√°ng 3, nh√≥m d·ªãch v·ª• t√†i ch√≠nh ti·∫øp t·ª•c tƒÉng ƒëi·ªÉm kh√° m·∫°nh, nh√≥m ng√¢n h√†ng c≈©ng c√≥ di·ªÖn bi·∫øn t√≠ch c·ª±c, nh√≥m b·∫•t ƒë·ªông s·∫£n v·ªõi th√¥ng tin kh·∫£ nƒÉng ti·∫øp t·ª•c h·∫° l√£i su·∫•t g√∫p thanh kho·∫£n c·∫£i thi·ªán t·ªët, nhi·ªÅu m√£ c√≥ t√≠n hi·ªáu tho√°t kh·ªèi xu h∆∞·ªõng gi·∫£m gi√° trung h·∫°n k√©o d√†i&hellip;</p>
<p>V·ªõi c√°c phi√™n tƒÉng gi·∫£m ƒëan xen, kh·ªëi l∆∞·ª£ng giao d·ªãch v·ªÅ t·ªïng th·ªÉ trung h·∫°n v·∫´n ƒëang ·ªü m·ª©c th·∫•p.</p>
<p>Giai ƒëo·∫°n cu·ªëi th√°ng 3, kh·ªëi l∆∞·ª£ng giao d·ªãch ƒëang trong xu h∆∞·ªõng gi·∫£m, cho th·∫•y c√°c trader ƒëang gi·∫£m d·∫ßn c√°c v·ªã th·∫ø n·∫Øm gi·ªØ v√† c√≥ th·ªÉ d·ªãch chuy·ªÉn sang ·ªü th·ªã tr∆∞·ªùng c∆° s·ªü khi tr√™n th·ªã tr∆∞·ªùng c∆° s·ªü ƒëang c√≥ nhi·ªÅu c∆° h·ªôi sinh l·ª£i ng·∫Øn h·∫°n t·ªët.
Th·ªã tr∆∞·ªùng ƒë√£ h·ªìi ph·ª•c 6 phi√™n li√™n ti·∫øp d√π ƒëi·ªÉm s·ªë tƒÉng t·ª´ng phi√™n kh√¥ng l·ªõn nh∆∞ng ƒë·ªß gi√∫p th·ªã tr∆∞·ªùng quay tr·ªü l·∫°i k√™nh tƒÉng gi√° ng·∫Øn h·∫°n v√† n·∫±m tr√™n ƒë∆∞·ªùng MA20.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">total_ban_theo_ngay</span> <span class="o">=</span> <span class="n">value_data</span><span class="o">.</span><span class="n">total_ban_30</span><span class="p">[</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

<span class="n">ngay_dau</span> <span class="o">=</span> <span class="n">total_ban_theo_ngay</span><span class="p">[</span><span class="s1">&#39;total_ban_30&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ngay_cuoi</span> <span class="o">=</span> <span class="n">total_ban_theo_ngay</span><span class="p">[</span><span class="s1">&#39;total_ban_30&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">phantramtangtruong</span> <span class="o">=</span> <span class="p">(</span><span class="n">ngay_cuoi</span> <span class="o">-</span> <span class="n">ngay_dau</span><span class="p">)</span><span class="o">/</span><span class="n">ngay_dau</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Tong so co phieu ban ra cua ngay cuoi giai doan so voi ngay dau co muc tang truong la: &#34;</span><span class="p">,</span><span class="n">phantramtangtruong</span><span class="p">)</span> 
<span class="c1"># --&gt; -0.637694475209741</span>

<span class="n">total_ban_theo_ngay</span> <span class="o">=</span> <span class="n">value_data</span><span class="o">.</span><span class="n">total_mua_30</span><span class="p">[</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

<span class="n">ngay_dau</span> <span class="o">=</span> <span class="n">total_ban_theo_ngay</span><span class="p">[</span><span class="s1">&#39;total_mua_30&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ngay_cuoi</span> <span class="o">=</span> <span class="n">total_ban_theo_ngay</span><span class="p">[</span><span class="s1">&#39;total_mua_30&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">phantramtangtruong</span> <span class="o">=</span> <span class="p">(</span><span class="n">ngay_cuoi</span> <span class="o">-</span> <span class="n">ngay_dau</span><span class="p">)</span><span class="o">/</span><span class="n">ngay_dau</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Tong so co phieu mua vao cua ngay cuoi giai doan so voi ngay dau co muc tang truong la: &#34;</span><span class="p">,</span><span class="n">phantramtangtruong</span><span class="p">)</span> 
<span class="c1"># --&gt; -0.8043500703402909</span>
</code></pre></td></tr></table>
</div>
</div><p>C√≥ th·ªÉ th·∫•y, s·ªë c·ªï phi·∫øu ƒë∆∞·ª£c b√°n ra ·ªü cu·ªëi giai ƒëo·∫°n (ƒë·∫ßu th√°ng 4) so v·ªõi th√°ng 3 c√≥ s·ª± s·ª•t gi·∫£m.
C·ªï phi·∫øu ƒë∆∞·ª£c mua v√†o c≈©ng tƒÉng tr∆∞·ªüng √¢m, c√°c nh√† ƒë·∫ßu t∆∞ bu·ªôc ph·∫£i gi·ªØ l·∫°i c√°c c·ªï phi·∫øu c√≤n t·ªìn ƒë·ªçng t·∫°o n√™n m·ªôt th·∫ø k√¨m h√£m thanh kho·∫£n. Do ƒë√≥, trong t∆∞∆°ng lai g·∫ßn s·∫Ω ch·ªãu t√°c ƒë·ªông c·ªßa s·ª± ch√™nh l·ªách n√†y.</p>
<h4 id="c√°c-s·ª±-ki·ªán-·∫£nh-h∆∞·ªüng" class="headerLink">
    <a href="#c%c3%a1c-s%e1%bb%b1-ki%e1%bb%87n-%e1%ba%a3nh-h%c6%b0%e1%bb%9fng" class="header-mark"></a>C√°c s·ª± ki·ªán ·∫£nh h∆∞·ªüng</h4><ul>
<li>Ng√†y 22-23/3/2023, l·∫ßn th·ª© 9 li√™n ti·∫øp FED tƒÉng l√£i su·∫•t, n√¢ng phaÃ£m vi laÃÉi su√¢ÃÅt l√™n m∆∞ÃÅc dao ƒë√¥Ã£ng t∆∞ÃÄ 4,75% ƒë√™ÃÅn 5%. M·ª•c ƒë√≠ch ƒë·ªÉ tr·∫•n an th·ªã tr∆∞·ªùng, gi·ªØ uy t√≠n v√† ch·ªëng l·∫°m ph√°t. Trong b·ªëi c·∫£nh thanh kho·∫£n tr√™n th·ªã tr∆∞·ªùng t√†i ch√≠nh qu·ªëc t·∫ø th·∫Øt ch·∫∑t h∆°n, Ch√≠nh ph·ªß v√† c√°c doanh nghi·ªáp Vi·ªát Nam s·∫Ω kh√≥ huy ƒë·ªông v·ªën tr√™n th·ªã tr∆∞·ªùng qu·ªëc t·∫ø v√† ph·∫£i ch·ªãu m·ª©c chi ph√≠ t√†i ch√≠nh cao h∆°n.</li>
<li>Ng√†y 31/3/2023, Ng√¢n h√†ng Nh√† n∆∞·ªõc Vi·ªát Nam ƒëi·ªÅu ch·ªânh gi·∫£m c√°c m·ª©c l√£i su·∫•t ƒëi·ªÅu h√†nh, c√≥ hi·ªáu l·ª±c t·ª´ ng√†y 03/4/2023&hellip;.</li>
<li>T·ª´ ƒë·∫ßu nƒÉm ƒë·∫øn nay, VNƒê ch·ªâ gi·∫£m gi√° 0.6% so v·ªõi USD, trong khi ƒë√≥ c√°c ƒë·ªìng ti·ªÅn kh√°c gi·∫£m gi√° nhi·ªÅu h∆°n so v·ªõi USD t·ª´ 20-30% cho th·∫•y n·ªôi t·∫°i v·ªØng ch·∫Øc c·ªßa kinh t·∫ø Vi·ªát Nam tr√™n ƒë∆∞·ªùng d√†i.</li>
</ul>
<h4 id="k·∫øt-lu·∫≠n-xu-h∆∞·ªõng" class="headerLink">
    <a href="#k%e1%ba%bft-lu%e1%ba%adn-xu-h%c6%b0%e1%bb%9bng" class="header-mark"></a>K·∫øt lu·∫≠n xu h∆∞·ªõng</h4><p>·ªû giai ƒëo·∫°n n√†y chi·ªÅu h∆∞·ªõng tƒÉng nh·∫π ƒë√£ di·ªÖn ra do ƒë√≥ th·ªã tr∆∞·ªùng c√≥ xu th·∫ø ƒëi l√™n. Th·ªã tr∆∞·ªùng ph√°i sinh c√≥ ti·ªÅm nƒÉng h·ªìi ph·ª•c v·ªÅ m·ª©c ƒëi·ªÉm ti·ªám c·∫≠n 1100. C√≥ th·ªÉ cho r·∫±ng th·ªã tr∆∞·ªùng s·∫Ω theo xu h∆∞·ªõng t√≠ch l≈©y v·ªõi bi·∫øn ƒë·ªông h·∫πp √≠t r·ªßi ro nh∆∞ng nh·ªØng nh·ªãp h·ªìi ph·ª•c s·∫Ω kh√¥ng qu√° m·∫°nh v√† kh√≥ k·ª≥ v·ªçng VN30 v∆∞·ª£t qua m·ª©c 1.150 ƒëi·ªÉm. V·ªÅ ng·∫Øn h·∫°n th·ªã tr∆∞·ªùng ƒëang cho th·∫•y vi·ªác tr·ªü l·∫°i k√™nh tƒÉng gi√° ng·∫Øn h·∫°n v·ªõi xung l·ª±c kh√° t·ªët, tuy nhi√™n nh√† ƒë·∫ßu t∆∞ n√™n h·∫°n ch·∫ø mua ƒëu·ªïi c·ªï phi·∫øu ·ªü c√°c v√πng gi√° cao m√† n√™n gi·∫£i ng√¢n theo h∆∞·ªõng t√≠ch l≈©y v√† duy tr√¨ t·ª∑ tr·ªçng c·ªï phi·∫øu ·ªü d∆∞·ªõi m·ª©c trung b√¨nh. C√≥ th·ªÉ k·∫øt lu·∫≠n, n·ª≠a cu·ªëi th√°ng 3 c√≥ xu h∆∞·ªõng <strong>UPTREND</strong>, nh∆∞ng v·ªÅ ƒë·∫ßu th√°ng 4 s·∫Ω tr·ªü v·ªÅ <strong>DOWNTREND</strong>.</p>
<h3 id="cluster-a" class="headerLink">
    <a href="#cluster-a" class="header-mark"></a>Cluster A</h3><p>H√£y c√πng xem qua Cluster A nh√©</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>

<span class="n">gtb</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">value_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;gttb_&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">value_data</span><span class="p">[</span><span class="n">gtb</span><span class="p">][</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">gtb</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mean Values by Label A&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&#34;Times&#34;</span><span class="p">,</span> <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&#34;Mean Values&#34;</span><span class="p">,</span>
<span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&#34;Courier New, monospace&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&#34;RebeccaPurple&#34;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><figure><a class="lightgallery" href="https://media.discordapp.net/attachments/1105503055916564572/1105552169488351293/Mean_Values_by_Label_A.png?width=807&amp;height=452" title="A-Correlation between Total Volumn and GiaKL" data-thumbnail="https://media.discordapp.net/attachments/1105503055916564572/1105552169488351293/Mean_Values_by_Label_A.png?width=807&amp;height=452" data-sub-html="<h2>A-Correlation between Total Volumn and GiaKL</h2><p>A-Correlation between Total Volumn and GiaKL</p>">
        <img
            
            loading="lazy"
            src="https://media.discordapp.net/attachments/1105503055916564572/1105552169488351293/Mean_Values_by_Label_A.png?width=807&amp;height=452"
            srcset="https://media.discordapp.net/attachments/1105503055916564572/1105552169488351293/Mean_Values_by_Label_A.png?width=807&amp;height=452, https://media.discordapp.net/attachments/1105503055916564572/1105552169488351293/Mean_Values_by_Label_A.png?width=807&amp;height=452 1.5x, https://media.discordapp.net/attachments/1105503055916564572/1105552169488351293/Mean_Values_by_Label_A.png?width=807&amp;height=452 2x"
            sizes="auto"
            alt="A-Correlation between Total Volumn and GiaKL" width="800" >
    </a><figcaption class="image-caption">A-Correlation between Total Volumn and GiaKL</figcaption>
    </figure>
<h4 id="bi·∫øn-ƒë·ªông-th·ªã-tr∆∞·ªùng-1" class="headerLink">
    <a href="#bi%e1%ba%bfn-%c4%91%e1%bb%99ng-th%e1%bb%8b-tr%c6%b0%e1%bb%9dng-1" class="header-mark"></a>Bi·∫øn ƒë·ªông th·ªã tr∆∞·ªùng</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">tb_SAB</span> <span class="o">=</span> <span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;gttb_SAB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Gia tri trung binh cua co phieu SAB&#34;</span><span class="p">,</span><span class="n">tb_SAB</span><span class="p">)</span> <span class="c1"># --&gt; 179.1409610698177</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>ƒê·ªëi v·ªõi gi√° c·ªï phi·∫øu trung b√¨nh:</strong></p>
<p>C√≥ th·ªÉ th·∫•y gi√° trung b√¨nh c·ªßa c·ªï phi·∫øu SAB (T·ªïng C√¥ng ty c·ªï ph·∫ßn Bia - R∆∞·ª£u - N∆∞·ªõc gi·∫£i kh√°t S√†i G√≤n SABECO) c√≥ giao ƒë·ªông kh√° ·ªïn ƒë·ªãnh xung quanh gi√° tr·ªã 165K. H∆°n n·ªØa gi√° trung b√¨nh c·ªßa SABECO trong th√°ng 4/2023 l√† cao h∆°n h·∫≥n so v·ªõi c√°c c·ªï phi·∫øu kh√°c trong VN30, ch·ª©ng t·ªè th·ªã ph·∫ßn c·ªßa c√¥ng ty ƒë√≥ trong ng√†nh c√≥ th·ªÉ ƒëang tƒÉng l√™n, v√† c√≥ th·ªÉ ƒë∆∞·ª£c ƒë√°nh gi√° cao b·ªüi c√°c nh√† ƒë·∫ßu t∆∞ v√¨ n√≥ c√≥ kh·∫£ nƒÉng tƒÉng tr∆∞·ªüng m·∫°nh trong t∆∞∆°ng lai.</p>
<p>Tuy nhi√™n t·ª´ ƒë·∫ßu th√°ng 4 v·ªÅ sau, ƒë·ªìng h√†nh c√πng v·ªõi SAB l√† kho·∫£ng 13 m√£ c·ªï phi·∫øu kh√°c nh∆∞ VJC, GAS, VCB&hellip; ƒëang c√≥ xu h∆∞·ªõng gi·∫£m gi√° nh·∫π.</p>
<p>M·ªôt s·ªë m√£ c·ªï phi·∫øu nh∆∞ VCB c√≥ s·ª± giao ƒë·ªông kh√° m·∫°nh m·∫Ω khi li√™n t·ª•c xu·ªëng ng∆∞·ª°ng 44K/1 c·ªï phi·∫øu trong c√°c ng√†y 20, 21/03/2023. V√† t·ª´ ƒë·∫ßu th√°ng 4 l√† s·ª± tu·ªôt d·ªëc kh√° nhanh khi t·ª´ kho·∫£ng 93K xu·ªëng c√≤n t·∫ßm 52K.</p>
<p>Ngo√†i ra c√≥ th·ªÉ th·∫•y r·∫±ng c·ªï phi·∫øu NVL c·ªßa T·∫≠p ƒëo√†n ƒê·∫ßu t∆∞ ƒê·ªãa ·ªëc NOVA kh√° &ldquo;·∫£m ƒë·∫°m&rdquo; khi ng∆∞·ª°ng th·∫•p nh·∫•t l√† v√†o ng√†y 03/04/2023 v·ªõi 2.7K v√† cao nh·∫•t l√† x·∫•p x·ªâ 11K. C√≥ l·∫Ω c·ªï phi·∫øu NVL ƒëang ng√†y c√†ng &ldquo;r·ªõt gi√°&rdquo;, ch√≠nh v√¨ v·∫≠y m√† c√°c nh√† ƒë·∫ßu t∆∞ n√™n b√°n th√°o, th·ªã tr∆∞·ªùng chung c≈©ng nh·∫≠n ƒë·ªãnh n√™n B√ÅN m·∫°nh.</p>
<p><strong>ƒê·ªëi v·ªõi kh·ªëi l∆∞·ª£ng mua b√°n c·ªï phi·∫øu:</strong></p>
<p>T·ª´ bi·ªÉu ƒë·ªì tr√™n, nh√¨n s∆° l∆∞·ª£c qua th√¨ ta c√≥ th·ªÉ th·∫•y ƒë∆∞·ª£c kh·ªëi l∆∞·ª£ng giao d·ªãch c√≥ xu h∆∞∆°ng tƒÉng d·∫ßn t·ª´ ng√†y 1/4, ch·∫°m m·ªëc cao nh·∫•t v√†o ng√†y 6/4. Trong kho·∫£ng th·ªùi gian n√†y, kh·ªëi l∆∞·ª£ng giao d·ªãch mua nhi·ªÅu, ƒëi·ªÅu n√†y ch·ª©ng t·ªè th·ªã tr∆∞·ªùng ƒëang r·∫•t quan t√¢m v√† k·ª≥ v·ªçng v√†o s·ª± tƒÉng gi√° c·ªßa c√°c c·ªï phi·∫øu. Gi√° ph√°i sinh v√† kh·ªëi l∆∞·ª£ng giao d·ªãch c√≥ m·ªôt s·ª± t∆∞∆°ng quan v·ªõi nhau, vi·ªác kh·ªëi l∆∞·ª£ng giao d·ªãch mua tƒÉng l√™n, gi√° ph√°i sinh trong kho·∫£ng th·ªùi gian n√†y c≈©ng ƒë√£ ƒë∆∞·ª£c ƒë·∫©y l√™n.</p>
<p>Sau s·ª± gia tƒÉng gi√° ƒë·∫øn m·ªôt m·ª©c cao nh·∫•t l√† v√†o ng√†y 6/4, th√¨ sau ƒë√≥ gi√° ph√°i sinh l·∫°i kh√° ·∫£m ƒë·∫°m. Sau ng√†y 17/4 th√¨ b·∫Øt ƒë·∫ßu c√≥ d·∫•u hi·ªáu gi·∫£m m·∫°nh v√† th·∫•p nh·∫•t v√†o ng√†y 19/4. Trong kho·∫£ng th·ªùi gian n√†y, kh·ªëi l∆∞·ª£ng giao d·ªãch c≈©ng gi·∫£m d·∫ßn, kh·ªëi l∆∞·ª£ng giao d·ªãch b√°n tƒÉng nhi·ªÅu h∆°n so v·ªõi k√¨ tr∆∞·ªõc. M·ª©c gi·∫£m n√†y nh·∫≠n ƒë·ªãnh l√† kh√° m·∫°nh, trong khi kh·ªëi l∆∞·ª£ng giao d·ªãch mua l·∫°i kh√¥ng nhi·ªÅu. Th·ªã tr∆∞·ªùng kh√¥ng c√≥ nhi·ªÅu ƒëi·ªÉm nh·∫•n trong b·ªëi c·∫£nh ph·ª•c h·ªìi thanh kho√°n th·∫•p.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">total_ban_theo_ngay</span> <span class="o">=</span> <span class="n">value_data</span><span class="o">.</span><span class="n">total_ban_30</span><span class="p">[</span><span class="n">value_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

<span class="n">ngay_dau</span> <span class="o">=</span> <span class="n">total_ban_theo_ngay</span><span class="p">[</span><span class="s1">&#39;total_ban_30&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ngay_cuoi</span> <span class="o">=</span> <span class="n">total_ban_theo_ngay</span><span class="p">[</span><span class="s1">&#39;total_ban_30&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">phantramtangtruong</span> <span class="o">=</span> <span class="p">(</span><span class="n">ngay_cuoi</span> <span class="o">-</span> <span class="n">ngay_dau</span><span class="p">)</span><span class="o">/</span><span class="n">ngay_dau</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Tong so co phieu ban ra cua ngay cuoi giai doan so voi ngay dau co muc tang truong la: &#34;</span><span class="p">,</span><span class="n">phantramtangtruong</span><span class="p">)</span>
<span class="c1"># --&gt; -0.7704310701624562</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>V·ªÅ bi·∫øn ƒë·ªông gi√° ph√°i sinh</strong>:</p>
<p>VN30Index phi√™n m·ªü ƒë·∫ßu th√°ng 4 giao d·ªãch tƒÉng ƒëi·ªÉm t√≠ch c·ª±c v√† duy tr√¨ ƒë√† tƒÉng ƒë·∫øn cu·ªëi phi√™n. S·ªë li·ªáu cu·ªëi c√πng ghi nh·∫≠n ƒë∆∞·ª£c v√†o ng√†y 03/04/2023 l√† 1.081,28 ƒëi·ªÉm (+1.38% so v·ªõi 1.070,14 v√†o 31/03/2023) ƒë·ªÉ h∆∞·ªõng ƒë·∫øn 1.085-1.095 ƒëi·ªÉm.</p>
<p>Tuy nhi√™n, v√†o tu·∫ßn th·ª© 2 t·ª´ 14/04/2023 VN30Index bi·∫øn ƒë·ªông ti√™u c·ª±c h∆°n. Phi√™n ƒë·∫ßu tu·∫ßn, m·ªü c·ª≠a ·ªü v√πng gi√° 1.073 ƒëi·ªÉm v√† ch·ªãu √°p l·ª±c ƒëi·ªÅu ch·ªânh ·ªü v√πng gi√° 1.070-1.075 ƒëi·ªÉm ƒë·ªÉ k·∫øt th√∫c tu·∫ßn giao d·ªãch v·ªõi phi√™n gi·∫£m ƒëi·ªÉm m·∫°nh. Tu·∫ßn ƒëi·ªÅu ch·ªânh ƒë√£ di·ªÖn ra nh∆∞ d·ª± ƒëo√°n khi trong tu·∫ßn qua Vn30Index gi·∫£m 16.82 ƒëi·ªÉm (-1,57%) v·ªõi kh·ªëi l∆∞·ª£ng giao d·ªãch ti·∫øp t·ª•c ·ªü m·ª©c cao, ƒëi·ªÉm s·ªë ƒëi·ªÅu ch·ªânh tuy kh√¥ng l·ªõn nh∆∞ng trong b·ªëi c·∫£nh th·ªã tr∆∞·ªùng ƒëang trong khu v·ª±c giao ƒë·ªông h·∫πp th√¨ ƒë·ª£t ƒëi·ªÅu ch·ªânh n√†y c≈©ng t·∫°o ra c·∫£m gi√°c b·∫•t an cho nh√† ƒë·∫ßu t∆∞.</p>
<p>ƒê·∫øn ng√†y 19/04/2023. N·ªó l·ª±c ph·ª•c h·ªìi t·ª´ 2 phi√™n ƒë·∫ßu tu·∫ßn ƒë√£ kh√¥ng ƒë∆∞·ª£c ti·∫øp t·ª•c duy tr√¨ trong phi√™n n√†y khi Th·ªùi ƒëi·ªÉm cu·ªëi c√πng l√† x·∫•p x·ªâ 1.055 ƒëi·ªÉm. S·ª•t gi·∫£m (-0,77%) v√† ƒë·ªëi di·ªán v·ªõi nguy c∆° ƒë√°nh m·∫•t k√™nh tƒÉng gi√° ng·∫Øn h·∫°n</p>
<h4 id="s·ª±-ki·ªán-·∫£nh-h∆∞·ªüng" class="headerLink">
    <a href="#s%e1%bb%b1-ki%e1%bb%87n-%e1%ba%a3nh-h%c6%b0%e1%bb%9fng" class="header-mark"></a>S·ª± ki·ªán ·∫£nh h∆∞·ªüng</h4><ul>
<li>
<p>Ng√†y 31/3, th√¥ng tin s·∫Ω c√≥ th√™m m·ªôt ƒë·ª£t gi·∫£m l√£i su·∫•t t·ª´ ph√≠a c√°c NHTM, ƒë·ªÅ xu·∫•t tri·ªÉn khai gi√£n ho√£n n·ª£ cho doanh nghi·ªáp. ƒê√¢y l√† ƒë·ªông l·ª±c t√≠ch c·ª±c h·ªó tr·ª£ cho thanh kho·∫£n c·ªßa th·ªã tr∆∞·ªùng c·∫£i thi·ªán th·ªÉ hi·ªán ·ªü nh√≥m d·ªãch v·ª• t√†i ch√≠nh ti·∫øp t·ª•c tƒÉng ƒëi·ªÉm kh√° m·∫°nh nh∆∞ BSI (+27,20%), FTS (18,01%), AGR (+14,51%),&hellip;</p>
</li>
<li>
<p>Ng√†y 14/4, B·ªô T√†i Ch√≠nh tr√¨nh Ch√≠nh ph·ªß b√°o c√°o Qu·ªëc h·ªôi xem x√©t ti·∫øp t·ª•c ch√≠nh s√°ch gi·∫£m 2% thu·∫ø GTGT nƒÉm 2023. Cho th·∫•y c√°c trader ƒëang gi·∫£m d·∫ßn c√°c v·ªã th·∫ø n·∫Øm gi·ªØ v√† ch∆∞a c√≥ k·ª≥ v·ªçng l·∫°c quan ƒë·ªëi v·ªõi ch·ªâ s·ªë VN30.</p>
</li>
<li>
<p>Ng√†y 17/4, thanh kho·∫£n tr√™n hai s√†n ni√™m y·∫øt ƒë·∫°t g·∫ßn 8.900 t·ªâ ƒë·ªìng, gi·∫£m 30% so v·ªõi phi√™n tr∆∞·ªõc, m·ª©c gi·∫£m kh√° m·∫°nh ƒë·∫∑c bi·ªát l√† trong th·ªùi ƒëi·ªÉm th·ªã tr∆∞·ªùng s·∫Øp k·∫øt th√∫c ƒë√°o h·∫°n ph√°i sinh.</p>
</li>
<li>
<p>Ng√†y 18/4, th·ªã tr∆∞·ªùng ƒë√≥n nh·∫≠n th√¥ng tin kh√° t√≠ch c·ª±c khi Ch√≠nh ph·ªß ƒë·ªìng √Ω tr√¨nh Qu·ªëc h·ªôi gi·∫£m 2% thu·∫ø VAT cho t·∫•t c·∫£ h√†ng h√≥a, d·ªãch v·ª• ƒëang ch·ªãu thu·∫ø 10%.</p>
</li>
</ul>
<h4 id="k·∫øt-lu·∫≠n-xu-h∆∞·ªõng-1" class="headerLink">
    <a href="#k%e1%ba%bft-lu%e1%ba%adn-xu-h%c6%b0%e1%bb%9bng-1" class="header-mark"></a>K·∫øt lu·∫≠n xu h∆∞·ªõng</h4><p><strong>DOWNTREND</strong></p>
<p>Nh√¨n chung, C√¥ng ty C·ªï ph·∫ßn Ch·ª©ng kho√°n SSI ƒë√°nh gi√° th·ªã tr∆∞·ªùng trong th√°ng 4 kh√¥ng qu√° l·∫°c quan nh∆∞ng c≈©ng kh√¥ng qu√° ti√™u c·ª±c. Th√°ch th·ª©c v·ªõi th·ªã tr∆∞·ªùng trong ng·∫Øn h·∫°n l·∫°i ti·∫øp t·ª•c h√¨nh th√†nh c∆° h·ªôi t·ªët cho c√°c nh√† ƒë·∫ßu t∆∞ d√†i h·∫°n.</p>
<p>Khi th·ªã tr∆∞·ªùng ch·ª©ng kho√°n c√≥ xu h∆∞·ªõng downtrend, nhi·ªÅu nh√† ƒë·∫ßu t∆∞ c√≥ th·ªÉ r∆°i v√†o tr·∫°ng th√°i s·ª£ h√£i, lo l·∫Øng v·ªÅ m·ª©c ƒë·ªô r·ªßi ro v√† c√≥ th·ªÉ b√°n ra c·ªï phi·∫øu c·ªßa m√¨nh, d·∫´n ƒë·∫øn s·ª± suy gi·∫£m c·ªßa gi√° tr·ªã c·ªï phi·∫øu. Tuy nhi√™n, ƒë·ªëi v·ªõi nh√† ƒë·∫ßu t∆∞ th√¥ng th·∫°o, th·ªã tr∆∞·ªùng downtrend c≈©ng cung c·∫•p c∆° h·ªôi ƒë·ªÉ mua v√†o c√°c c·ªï phi·∫øu ·ªü m·ª©c gi√° th·∫•p h∆°n, ƒë·ªìng th·ªùi n·∫Øm b·∫Øt c√°c c∆° h·ªôi ƒë·∫ßu t∆∞ m·ªõi c√≥ th·ªÉ xu·∫•t hi·ªán trong th·ªùi gian t·ªõi.</p>
<h2 id="k·∫øt-th√∫c" class="headerLink">
    <a href="#k%e1%ba%bft-th%c3%bac" class="header-mark"></a>K·∫øt th√∫c</h2><p>Qua ƒë·ªì √°n ‚ÄúStock Analysis‚Äù ch√∫ng ta ƒë√£ th·ª±c h√†nh d√πng c√°c k·ªπ thu·∫≠t nh∆∞ Cleaning data, Scaling, PCA, K-means Clustering‚Ä¶ c√πng c√°c k·ªπ nƒÉng ph√¢n t√≠ch d·ªØ li·ªáu ƒë·ªÉ l√†m r√µ insight c√πng v·ªõi t√¨nh h√¨nh c·ªßa th·ªã tr∆∞·ªùng ch·ª©ng kho√°n ph√°i sinh VN30 trong 31 ng√†y. T·ª´ ƒë√¢y c√≥ th·ªÉ nh·∫≠n ƒë·ªãnh xu h∆∞·ªõng c·ªßa ch·ª©ng kho√°n trong th·ªùi gian t·ªõi, ƒë√≥ l√† xu h∆∞·ªõng t√≠ch l≈©y. M·ªôt s·ªë h·ª£p ƒë·ªìng c√≥ th·ªÉ tham kh·∫£o nh∆∞ VN30F2306 v√† VN30F2Q ƒë∆∞·ª£c d·∫´n d·∫Øt b·ªüi c√°c c·ªï phi·∫øu thu·ªôc nh√≥m ng√†nh x√¢y d·ª±ng (DIG), ng√¢n h√†ng (VCB), ch·ª©ng kho√°n (SSI)&hellip;</p>
<p>C·∫£m ∆°n b·∫°n ƒë√£ ƒë·ªçc ƒë·∫øn gi·ªù ph√∫t n√†y, OG c·∫£m ƒë·ªông qu√° üòÑ Hy v·ªçng b√†i vi·∫øt n√†y s·∫Ω gi√∫p cho b·∫°n c·∫£m th·∫•y th√∫ v·ªã.</p>
<p>Ch√∫c b·∫°n m·ªôt ng√†y t·ªët l√†nh üòÑ</p>
<p><strong>-Mew-</strong></p>
<hr>
<h1 id="related" class="headerLink">
    <a href="#related" class="header-mark"></a>Related</h1>
<div class="showcase-box column-2">
    <div class="showcase-image">
        <a href=/football_etl/><img
        
        loading="lazy"
        src="/img/projects-football.jpg"
        srcset="/img/projects-football.jpg, /img/projects-football.jpg 1.5x, /img/projects-football.jpg 2x"
        sizes="auto"
        alt="Football ETL Analysis"
        title="Football ETL Analysis" height="200"   width="400" ></a>
    </div>
    <h2 class="showcase-title">
        <a href=/football_etl/>Football ETL Analysis</a>
    </h2>
    <p class="showcase-summary">
        A Data Engineer project building pipeline to analyze football data
    </p>
    <a class="showcase-link" href=/football_etl/>
        Read more...
    </a>
</div>

<div class="showcase-box column-2">
    <div class="showcase-image">
        <a href=/stock_analysis/><img
        
        loading="lazy"
        src="/img/projects-stock.jpg"
        srcset="/img/projects-stock.jpg, /img/projects-stock.jpg 1.5x, /img/projects-stock.jpg 2x"
        sizes="auto"
        alt="Stock Analysis"
        title="Stock Analysis" height="200"   width="400" ></a>
    </div>
    <h2 class="showcase-title">
        <a href=/stock_analysis/>Stock Analysis</a>
    </h2>
    <p class="showcase-summary">
        Stock Analysis using PCA and K-means
    </p>
    <a class="showcase-link" href=/stock_analysis/>
        Read more...
    </a>
</div></div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 05 Sep 2023</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share"><button title="Share on Facebook" data-sharer="facebook" data-url="https://phonghuynh.netlify.app/stock_analysis_2/" data-hashtag="Machine learning"><span class="fab fa-facebook-square fa-fw"></span></button><button title="Share on Linkedin" data-sharer="linkedin" data-url="https://phonghuynh.netlify.app/stock_analysis_2/"><span class="fab fa-linkedin fa-fw"></span></button></div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/machine-learning/">Machine learning</a>,&nbsp;<a href="/tags/math/">math</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/stock_analysis/" class="prev" rel="prev" title="Stock analysis"><i class="fas fa-angle-left fa-fw"></i>Stock analysis</a>
            <a href="/spotify_analysis/" class="next" rel="next" title="Spotify_analysis">Spotify_analysis<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2023 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank" rel="noopener noreferrer">OG</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div></footer></div>

    <div id="fixed-buttons"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="Back to Top">
            <i class="fas fa-arrow-up fa-fw"></i>
        </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
            <i class="fas fa-comment fa-fw"></i>
        </a>
    </div><div class="assets"><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/katex/copy-tex.min.css">
        <noscript><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"></noscript><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"sharerjs":true,"table":{"sort":true}};</script><script type="text/javascript" src="/lib/tablesort/tablesort.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js" defer></script><script type="text/javascript" src="/lib/katex/auto-render.min.js" defer></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js" defer></script><script type="text/javascript" src="/lib/katex/mhchem.min.js" defer></script><script type="text/javascript" src="/js/katex.min.js" defer></script><script type="text/javascript" src="/js/theme.min.js" defer></script></div>
</body>

</html>