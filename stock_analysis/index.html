

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title>Stock analysis - OG Page</title><meta name="Description" content="Stock Analysis using PCA and K-means"><meta property="og:title" content="Stock analysis" />
<meta property="og:description" content="Stock Analysis using PCA and K-means" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://phonghuynh.netlify.app/stock_analysis/" /><meta property="og:image" content="https://phonghuynh.netlify.app/img/projects-stock.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-31T14:39:53+07:00" />
<meta property="article:modified_time" content="2023-08-31T14:39:53+07:00" /><meta property="og:site_name" content="OG Page" />
<meta property="og:see_also" content="https://phonghuynh.netlify.app/stock_analysis_2/" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://phonghuynh.netlify.app/img/projects-stock.jpg"/>

<meta name="twitter:title" content="Stock analysis"/>
<meta name="twitter:description" content="Stock Analysis using PCA and K-means"/>
<meta name="application-name" content="OG">
<meta name="apple-mobile-web-app-title" content="OG">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://phonghuynh.netlify.app/stock_analysis/" /><link rel="prev" href="https://phonghuynh.netlify.app/football_etl_2/" /><link rel="next" href="https://phonghuynh.netlify.app/stock_analysis_2/" />
<link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/color.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/fontawesome-free/all.min.css">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/animate/animate.min.css">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Stock analysis",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/phonghuynh.netlify.app\/stock_analysis\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/phonghuynh.netlify.app\/avata.jpg",
                            "width":  960 ,
                            "height":  960 
                        }],"genre": "posts","keywords": "Machine learning, math","wordcount":  3829 ,
        "url": "https:\/\/phonghuynh.netlify.app\/stock_analysis\/","datePublished": "2023-08-31T14:39:53+07:00","dateModified": "2023-08-31T14:39:53+07:00","publisher": {
            "@type": "Organization",
            "name": "OG Page","logo": "https:\/\/phonghuynh.netlify.app\/favicon.icon"},"authors": [{
                        "@type": "Person",
                        "name": "OG"                    
                    }],"description": "Stock Analysis using PCA and K-means"
    }
    </script><script src="//instant.page/5.2.0" defer type="module" integrity="sha384-jnZyxPjiipYXnSU0ygqeac2q7CVYMbh84q0uHVRRxEtvFPiQYbXWUorga2aqZJ0z"></script>
</head>

<body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">
        function setTheme(theme) {document.body.setAttribute('theme', theme); document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark'); window.theme = theme;   window.isDark = window.theme !== 'light' }
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('auto' === 'light' || 'auto' === 'dark' || 'auto' === 'black') setTheme('auto'), saveTheme('auto'); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let metaColors = {'light': '#f8f8f8','dark': '#252627','black': '#000000'}
        getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
        window.switchThemeEventSet = new Set()
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="OG Page"><img
        class="logo"
        loading="lazy"
        src="/favicon.ico"
        srcset="/favicon.ico, /favicon.ico 1.5x, /favicon.ico 2x"
        sizes="auto"
        alt="/favicon.ico"
        title="/favicon.ico" >OG Page</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/blogs/" title="OG&#39;s blogs"> Blogs </a><a class="menu-item" href="/tags/" title="Tags of blogs"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/projects/"> Projects </a><a class="menu-item" href="/about/"> About </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="OG Page"><img
        class="logo"
        loading="lazy"
        src="/favicon.ico"
        srcset="/favicon.ico, /favicon.ico 1.5x, /favicon.ico 2x"
        sizes="auto"
        alt="/favicon.ico"
        title="/favicon.ico" >OG Page</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/blogs/" title="OG&#39;s blogs">Blogs</a><a class="menu-item" href="/tags/" title="Tags of blogs">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/projects/" title="">Projects</a><a class="menu-item" href="/about/" title="">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
            <div class="container"><div class="toc" id="toc-auto">
        <h2 class="toc-title">Contents</h2>
        <div class="toc-content always-active" id="toc-content-auto"><nav id="TableOfContents">
  <ul>
    <li><a href="#intro">Intro</a></li>
    <li><a href="#exploratory-data-analysis">Exploratory Data Analysis</a>
      <ul>
        <li><a href="#data-acquistion">Data Acquistion</a></li>
        <li><a href="#a-brief-view">A Brief View</a></li>
      </ul>
    </li>
    <li><a href="#data-preprocessing">Data Preprocessing</a>
      <ul>
        <li><a href="#data-cleaning">Data Cleaning</a></li>
        <li><a href="#data-transforming">Data transforming</a></li>
        <li><a href="#data-scaling">Data Scaling</a></li>
      </ul>
    </li>
    <li><a href="#principle-component-analysis-pca">Principle Component Analysis (PCA)</a>
      <ul>
        <li><a href="#eigenvector-v√†-eigenvalue">EigenVector v√† EigenValue</a></li>
        <li><a href="#cumulative-sum-of-components">Cumulative Sum of Components</a></li>
        <li><a href="#scree-chart">Scree Chart</a></li>
        <li><a href="#visualize-pca">Visualize PCA</a></li>
      </ul>
    </li>
    <li><a href="#to-be-continue">To be Continue</a></li>
  </ul>
</nav></div>
    </div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Stock analysis</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><span class='author'><span class="author fas fa-user-circle fa-fw"></span><span class='screen-reader-text'>  </span><a href='https://phonghuynh.netlify.app/authors/og'>OG</a></span>
                </span>&nbsp;<span class="post-category">included in </span>&nbsp;<span class="post-category">category <a href="/categories/projects/"><i class="far fa-folder fa-fw"></i>projects</a></span>&nbsp;<span class="post-category">and</span>&nbsp;<span class="post-series">series <a href="/series/stock-analysis/"><i class="far fa-list-alt fa-fw"></i>Stock Analysis</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="31 Aug 2023">31 Aug 2023</time>&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;18 minutes&nbsp;</div>
        </div><div class="details series-nav open">
                                <div class="details-summary series-title">
                                    <span>Series - Stock Analysis</span>
                                    <span><i class="details-icon fas fa-angle-right"></i></span>
                                </div>
                                <div class="details-content series-content">
                                    <nav>
                                        <ul><li><span class="active">Stock analysis</span></li>
                                                    <li><a href="/stock_analysis_2/">Stock Analysis P2</a></li></ul>
                                    </nav>
                                </div>
                            </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#intro">Intro</a></li>
    <li><a href="#exploratory-data-analysis">Exploratory Data Analysis</a>
      <ul>
        <li><a href="#data-acquistion">Data Acquistion</a></li>
        <li><a href="#a-brief-view">A Brief View</a></li>
      </ul>
    </li>
    <li><a href="#data-preprocessing">Data Preprocessing</a>
      <ul>
        <li><a href="#data-cleaning">Data Cleaning</a></li>
        <li><a href="#data-transforming">Data transforming</a></li>
        <li><a href="#data-scaling">Data Scaling</a></li>
      </ul>
    </li>
    <li><a href="#principle-component-analysis-pca">Principle Component Analysis (PCA)</a>
      <ul>
        <li><a href="#eigenvector-v√†-eigenvalue">EigenVector v√† EigenValue</a></li>
        <li><a href="#cumulative-sum-of-components">Cumulative Sum of Components</a></li>
        <li><a href="#scree-chart">Scree Chart</a></li>
        <li><a href="#visualize-pca">Visualize PCA</a></li>
      </ul>
    </li>
    <li><a href="#to-be-continue">To be Continue</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><div class="details admonition warning open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-exclamation-triangle fa-fw"></i>Warning<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">ƒê√¢y l√† ki·∫øn th·ª©c t√≠ch g√≥p t·ª´ nhi·ªÅu ngu·ªìn v√† nghi√™n c·ª©u c·ªßa nh√≥m OG, t·∫•t nhi√™n kh√¥ng th·ªÉ tr√°nh kh·ªèi sai s√≥t.
Hy v·ªçng b√†i vi·∫øt l·∫ßn n√†y th√∫ v·ªã v√† gi√∫p b·∫°n ƒë·ªçc th∆∞ gi√£n, tham kh·∫£o.</div>
        </div>
    </div>
<p><strong>Source</strong>
<a target="_blank" href="https://github.com/PhongHuynh0394/Stock-Analysis" title="PhongHuynh0394" class="friend-link" rel="noopener noreferrer">
    <div class="friend-link-div">
        <div class="friend-link-avatar"><img
        
        loading="lazy"
        src="/img/github-logo.png"
        srcset="/img/github-logo.png, /img/github-logo.png 1.5x, /img/github-logo.png 2x"
        sizes="auto"
        alt="/img/github-logo.png"
        title="/img/github-logo.png" height="560"   width="560" ></div>
        <div class="friend-link-info">
            <div class="friend-name-div">
                <i class="fas fa-user-circle fa-fw"></i>
                <i class="friend-name">PhongHuynh0394</i>
            </div>
            <p class="friend-bio">Stock-Analysis</p>
        </div>
    </div>
</a></p>
<p>Hello! OG ƒë√¢y. ·ªû project l·∫ßn n√†y m√¨nh s·∫Ω ph√¢n t√≠ch gia tr·ªã c·ªï phi·∫øu ph√°i sinh VN30 Index b·∫±ng c√°ch s·ª≠ d·ª•ng PCA v√† K-means. Xin v√¥ c√πng c·∫£m ∆°n
s·ª± ƒë√≥ng g√≥p c·ªßa 5 th√†nh vi√™n team OG v√† th·∫ßy Minh M·∫´n v√† th·∫ßy Ho√†ng ƒê·ª©c ƒë√£ t·∫≠n t√¨nh h∆∞·ªõng d·∫´n ƒë·ªÉ team c√≥ th·ªÉ ho√†n th√†nh ƒë·ªì √°n m·ªôt c√°ch t·ªët nh·∫•t.</p>
<p>R·ªìi b√¢y gi·ªù g√©t g√¥ thooiii üòÑ
<figure><a class="lightgallery" href="/img/projects-stock.jpg" title="Stock Analysis" data-thumbnail="/img/projects-stock.jpg">
        <img
            
            loading="lazy"
            src="/img/projects-stock.jpg"
            srcset="/img/projects-stock.jpg, /img/projects-stock.jpg 1.5x, /img/projects-stock.jpg 2x"
            sizes="auto"
            alt="Stock Analysis" height="533"  width="995" >
    </a></figure></p>
<h2 id="intro" class="headerLink">
    <a href="#intro" class="header-mark"></a>Intro</h2><p>Stock Analysis hay c√≤n g·ªçi l√† Market Analysis ƒë·ªÅ c·∫≠p ƒë·∫øn ph∆∞∆°ng ph√°p m√† nh√† ƒë·∫ßu t∆∞ ho·∫∑c nh√† giao d·ªãch s·ª≠ d·ª•ng ƒë·ªÉ ƒë√°nh gi√° v√† ƒëi·ªÅu tra m·ªôt c√¥ng c·ª• giao d·ªãch c·ª• th·ªÉ, lƒ©nh v·ª±c ƒë·∫ßu t∆∞ ho·∫∑c to√†n b·ªô th·ªã tr∆∞·ªùng ch·ª©ng kho√°n.
Kh√¥ng nh·ªØng th·∫ø, n√≥ li√™n quan ƒë·∫øn vi·ªác nghi√™n c·ª©u d·ªØ li·ªáu th·ªã tr∆∞·ªùng trong qu√° kh·ª© v√† hi·ªán t·∫°i v√† t·∫°o ra m·ªôt ph∆∞∆°ng ph√°p ƒë·ªÉ ch·ªçn c·ªï phi·∫øu ph√π h·ª£p ƒë·ªÉ giao d·ªãch. C√°c nh√† ƒë·∫ßu t∆∞ s·∫Ω ƒë∆∞a ra quy·∫øt ƒë·ªãnh mua ho·∫∑c b√°n d·ª±a tr√™n th√¥ng tin ph√¢n t√≠ch ch·ª©ng kho√°n.</p>
<p>Trong project n√†y ta s·∫Ω ph√¢n t√≠ch, tr·ª±c quan h√≥a b·ªô d·ªØ li·ªáu gi·∫£ ƒë·ªãnh ƒë∆∞·ª£c cung c·∫•p b·ªüi kh√°ch h√†ng ƒë·ªÉ ƒë√°nh gi√° th·ªã tr∆∞·ªùng ch·ª©ng kho√°n
trong kho·∫£ng th·ªùi gian 1 th√°ng c·ªßa 30 c√¥ng ty thu·ªôc VN30</p>
<p>D∆∞·ªõi ƒë√¢y l√† t√≥m t·∫Øt s∆° l∆∞·ª£c t·ª´ng b∆∞·ªõc ƒë·ªÉ x·ª≠ l√Ω v√† ph√¢n t√≠ch:</p>
<ol>
<li>EDA (Exploratory Data Analysis)</li>
<li>Data Preprocessing</li>
<li>PCA (Principle Component Analysis)</li>
<li>K-Means Clustering</li>
<li>Data Analysis</li>
<li>References (chi ti·∫øt trong notebook ·ªü github)</li>
</ol>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw"></i>Raw Data<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>Source: <a href="https://github.com/PhongHuynh0394/My-respository/blob/main/df_merged.pkl" target="_blank" rel="noopener noreferrer">df_merged.pkl</a></p>
<p>Raw data l√† d·ªØ li·ªáu b·∫£ng gi√° c·ªï phi·∫øu c·ªßa 30 c√¥ng ty thu·ªôc VN30 Index + 1 tr∆∞·ªùng gi√° ph√°i sinh trong 1 th√°ng</p>
</div>
        </div>
    </div>
<h2 id="exploratory-data-analysis" class="headerLink">
    <a href="#exploratory-data-analysis" class="header-mark"></a>Exploratory Data Analysis</h2><p>ƒê√¢y l√† b∆∞·ªõc ƒë·∫ßu ti√™n, ch√∫ng ta s·∫Ω c√πng nhau t√¨m hi·ªÉu s∆° l∆∞·ª£c raw data c≈©ng nh∆∞ t√¨m hi·ªÉu c√°i nh√¨n t·ªïng qu√°t v·ªÅ
d·ªØ li·ªáu ta s·∫Øp ph·∫£i ph√¢n t√≠ch ƒë·ªÉ t·ª´ ƒë√≥ c√≥ c√°ch ti·ªÅn x·ª≠ l√Ω ph√π h·ª£p. L√†m g√¨ th√¨ l√†m c·ª© ph·∫£i import packages ƒë·ªÉ ƒë·ªçc data c√°i ƒë√£</p>
<h3 id="data-acquistion" class="headerLink">
    <a href="#data-acquistion" class="header-mark"></a>Data Acquistion</h3><p>Ta s·∫Ω import m·ªôt s·ªë packages quen thu·ªôc ƒë·ªÉ ƒë·ªçc file <a href="https://github.com/PhongHuynh0394/My-respository/blob/main/df_merged.pkl" target="_blank" rel="noopener noreferrer">df_merged.pkl</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;https://github.com/PhongHuynh0394/My-respository/blob/main/df_merged.pkl?raw=true&#39;</span><span class="p">)</span>
<span class="c1"># Check the data type</span>
<span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1"># --&gt; list</span>
</code></pre></td></tr></table>
</div>
</div><p>Data nh·∫≠n ƒë∆∞·ª£c t·ª´ pickle file l√† m·ªôt list, b√¢y gi·ªù ta s·∫Ω t√¨m ki·∫øm c√°i nh√¨n t·ªïng quan v·ªÅ d·ªØ li·ªáu n√†y</p>
<h3 id="a-brief-view" class="headerLink">
    <a href="#a-brief-view" class="header-mark"></a>A Brief View</h3><ul>
<li>D·ªØ li·ªáu l∆∞u ·ªü pickle l√† m·ªôt list ch·ª©a 23 dataframe (df)</li>
<li>M·ªói df c√≥ index theo datetime (nghƒ©a l√† ƒë√¢y l√† lo·∫°i d·ªØ li·ªáu thu·ªôc timeseries)</li>
<li>C√°c columns l·∫ßn l∆∞·ª£t l√† t·ª´ng m√£ c·ªï phi·∫øu, ch·ª©a kh·ªëi l∆∞·ª£ng/ gi√° c·ªßa c√°c l·ªánh mua/b√°n s√°t v·ªõi l·ªánh kh·ªõp I v√† kh·ªëi l∆∞·ª£ng c·ªßa c√°c l·ªánh mua/b√°n s√°t v·ªõi gi√° kh·ªõp l·ªánh II</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;So luong df:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="c1"># --&gt; So luong df: 23</span>
</code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="/img/stock-data.png" title="raw data" data-thumbnail="/img/stock-data.png" data-sub-html="<h2>Raw data l√† gi√° l·ªánh mua/b√°n I II v√† kh·ªëi l∆∞·ª£ng giao d·ªãch c·ªßa c·ªï phi·∫øu 30 c√¥ng ty VN30</h2><p>raw data</p>">
        <img
            
            loading="lazy"
            src="/img/stock-data.png"
            srcset="/img/stock-data.png, /img/stock-data.png 1.5x, /img/stock-data.png 2x"
            sizes="auto"
            alt="raw data" height="823"  width="1227" >
    </a><figcaption class="image-caption">Raw data l√† gi√° l·ªánh mua/b√°n I II v√† kh·ªëi l∆∞·ª£ng giao d·ªãch c·ªßa c·ªï phi·∫øu 30 c√¥ng ty VN30</figcaption>
    </figure></p>
<p>Th·ªùi gian thu th·∫≠p ƒë∆∞·ª£c c·∫≠p nh·∫≠t v·ªõi chu k√¨ l√† 10 gi√¢y b·∫Øt ƒë·∫ßu t·ª´ ng√†y 20 th√°ng 3 ƒë·∫øn ng√†y 19 th√°ng 4, t·ª´ 2 gi·ªù 15 ƒë·∫øn 7 gi·ªù 30 m·ªói ng√†y. Nh∆∞ng c√≥ m·ªôt s·ªë ng√†y b·ªã miss trong b·ªô d·ªØ li·ªáu n√†y (Chi ti·∫øt h∆°n trong notebook ·ªü source code)</p>
<p>C√πng xem qua v·ªÅ s·ªë l∆∞·ª£ng observations c·ªßa m·ªói b·∫£ng
<figure><a class="lightgallery" href="/img/stock-view.png" title="dataframe shape" data-thumbnail="/img/stock-view.png">
        <img
            
            loading="lazy"
            src="/img/stock-view.png"
            srcset="/img/stock-view.png, /img/stock-view.png 1.5x, /img/stock-view.png 2x"
            sizes="auto"
            alt="dataframe shape" height="690"  width="1171" >
    </a></figure>
T·ªïng c·ªông ta c√≥ 181 fields v√† m·ªói b·∫£ng kho·∫£ng 1345 observations (t·ªïng c·ªông 30538 quan s√°t). C≈©ng kh√° nhi·ªÅu ph·∫£i kh√¥ng n√†o. Ta s·∫Ω c√πng ti·ªÅn x·ª≠ l√Ω ch√∫ng n√†o</p>
<h2 id="data-preprocessing" class="headerLink">
    <a href="#data-preprocessing" class="header-mark"></a>Data Preprocessing</h2><p>Sau khi ƒë√£ bi·∫øt kh√°i qu√°t raw data, ta s·∫Ω c·∫ßn ph·∫£i ti·ªÅn x·ª≠ l√Ω nh·ªØng d·ªØ li·ªáu th√¥ n√†y tr∆∞·ªõc khi c√≥ th·ªÉ √°p d·ª•ng c√°c m√¥ h√¨nh m√°y h·ªçc ho·∫∑c gi·∫£m chi·ªÅu d·ªØ li·ªáu</p>
<h3 id="data-cleaning" class="headerLink">
    <a href="#data-cleaning" class="header-mark"></a>Data Cleaning</h3><p>H√£y s·ª≠ d·ª•ng method describe() c·ªßa pandas ƒë·ªÉ c√≥ c√°i nh√¨n s∆° b·ªô nh·∫•t v·ªÅ df c·ªßa ch√∫ng ta</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>ƒê·∫ßu ti√™n, ta s·∫Ω drop duplicate v√† ƒë·ªãnh d·∫°ng l·∫°i index th·ªùi gian</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">market</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span> <span class="c1">#create empty df</span>

<span class="c1"># Data cleaning</span>
<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
  <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

  <span class="n">cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

  <span class="c1">#convert/ replace 0</span>
  <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

  <span class="c1"># #missing handling</span>
  <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

  <span class="n">market</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">market</span><span class="p">,</span><span class="n">df</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1">#concat all clean df into market</span>

<span class="c1">#datetime format</span>
<span class="n">market</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">market</span> <span class="o">=</span> <span class="n">market</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;datetime&#39;</span><span class="p">})</span>
<span class="n">market</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">market</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
<span class="n">market</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">market</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">])</span>
<span class="n">market</span> <span class="o">=</span> <span class="n">market</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&#34;datetime&#34;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">market</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;datetime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>K·∫ø ti·∫øp h√£y x·ª≠ l√Ω missing value b·∫±ng ph∆∞∆°ng ph√°p n·ªôi suy (interpolation) v·ªõi method <code>padding</code>, v√† sau ƒë√≥ s·∫Ω d√πng <code>backfill</code></p>
<p>ƒê√¢y l√† ph∆∞∆°ng ph√°p ∆∞·ªõc t√≠nh gi√° tr·ªã c·ªßa c√°c ƒëi·ªÉm d·ªØ li·ªáu ch∆∞a bi·∫øt trong ph·∫°m vi c·ªßa m·ªôt t·∫≠p h·ª£p r·ªùi r·∫°c ch·ª©a m·ªôt s·ªë ƒëi·ªÉm d·ªØ li·ªáu ƒë√£ bi·∫øt.
Nghe c√≥ v·∫ª l·∫±ng nh·∫±ng, ƒë∆°n gi·∫£n l√† th·∫ø n√†y:</p>
<ol>
<li><strong>.interpolate(method=&lsquo;pad&rsquo;)</strong>: fill null values b·∫±ng gi√° tr·ªã li·ªÅn k·ªÅ n√≥ l·∫ßn l∆∞·ª£t t·ª´ tr√™n xu·ªëng (n√≥ gi·ªëng nh∆∞ <code>ffill()</code>)</li>
<li><strong>.fillna(method=&lsquo;backfill&rsquo;)</strong>: ƒê√¢y l√† ph∆∞∆°ng ph√°p ng∆∞·ª£c l·∫°i b√™n tr√™n, fill null b·∫±ng gi√° tr·ªã li·ªÅn k·ªÅ t·ª´ d∆∞·ªõi l√™n</li>
</ol>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw"></i>Note<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>C√≥ r·∫•t nhi·ªÅu ph∆∞∆°ng ph√°p n·ªôi suy nh∆∞ <code>linear</code> (default) hay <code>polynomial</code>,&hellip; Nh∆∞ng OG ch·ªçn padding v√† backfill v√¨
2 ph∆∞∆°ng ph√°p n√†y c√≥ th·ªÉ gi·ªØ cho data missing ·ªü gi√° tr·ªã s√°t nh·∫•t v·ªõi gi√° tr·ªã th·ª±c g·∫ßn nh·∫•t v√† gi√∫p cho k·∫øt qu·∫£ sau khi fill s√°t v·ªõi th·ª±c t·∫ø nh·∫•t.</p>
<p>Ngo√†i ra 2 ph∆∞∆°ng ph√°p n√†y c√≥ th·ªÉ fill ƒë∆∞·ª£c v·ªã tr√≠ ƒë·∫ßu v√† cu·ªëi c√πng m·ªôt c√°ch hi·ªáu qu·∫£.</p>
</div>
        </div>
    </div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">handle_null</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
  <span class="s1">&#39;&#39;&#39;
</span><span class="s1">  handle missing value
</span><span class="s1">  &#39;&#39;&#39;</span>
  <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
    <span class="n">X</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pad&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">X</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;backfill&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
  <span class="k">return</span> <span class="n">X</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="data-transforming" class="headerLink">
    <a href="#data-transforming" class="header-mark"></a>Data transforming</h3><p>OG nh·∫≠n th·∫•y r·∫±ng v·ªõi c√°c tr∆∞·ªùng data hi·ªán t·∫°i ch∆∞a th·ª±c s·ª± gi√∫p √≠ch qu√° nhi·ªÅu trong vi·ªác ph√¢n t√≠ch sau n√†y (gi√° mua/b√°n v√† s·ªë l∆∞·ª£ng mua/b√°n + gi√° ph√°i sinh (<strong>label</strong>) )</p>
<p>Do ƒë√≥ OG c·∫ßn m·ªôt dataframe m·ªõi v·ªõi c√°c tr∆∞·ªùng m·ªõi c√≥ nhi·ªÅu gi√° tr·ªã ph√¢n t√≠ch h∆°n:</p>
<ul>
<li><strong>gttb_ (Gi√° tr·ªã trung b√¨nh)</strong>: l√† column m·ªõi ƒë∆∞·ª£c t√≠nh tr√™n b√¨nh qu√¢n gi√° c·∫£ mua v√†o, b√°n ra c·ªßa t·ª´ng c·ªï phi·∫øu ƒë∆∞·ª£c giao d·ªãch TH√ÄNH C√îNG tr√™n th·ªã tr∆∞·ªùng.</li>
<li><strong>total_ban &amp; total_mua (T·ªïng b√°n/mua kh·ªëi l∆∞·ª£ng 1)</strong>: l√† column m·ªõi ƒë·ªÉ t√≠nh t·ªïng gi√° b√°n kh·ªëi l∆∞·ª£ng 1 c≈©ng nh∆∞ mua kh·ªëi l∆∞·ª£ng 1 c·ªßa t·ª´ng c·ªë phi·∫øu ƒë∆∞·ª£c giao d·ªãch tr√™n th·ªã tr∆∞·ªùng.</li>
<li><strong>Gia_KL</strong>: sao ch√©p gi√° kh·ªëi l∆∞·ª£ng c·ªßa t·ª´ng m√£ c·ªï phi·∫øu t·ª´ b·ªô d·ªØ li·ªáu ban ƒë·∫ßu. (<strong>label</strong>)</li>
<li><strong>C√†i ƒë·∫∑t l·∫°i index th·ªùi gian</strong>: group by c√°c time-series theo ph√∫t.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">transform_raw</span><span class="p">(</span><span class="n">market</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
  <span class="c1"># split stock name</span>
  <span class="n">name</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_1&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">market</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;mua_gia_1&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">]</span>
  <span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
    <span class="c1"># calculate gttb (mean)</span>
    <span class="n">new_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;gttb_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">market</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;mua_gia_1</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">market</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;mua_kl_1</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
                      <span class="o">+</span> <span class="n">market</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ban_gia_1</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">market</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ban_kl_1</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
                      <span class="o">/</span><span class="p">(</span><span class="n">market</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;mua_kl_1</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">market</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ban_kl_1</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="c1"># get ban_kl and mua_kl</span>
    <span class="n">new_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;total_ban_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">market</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ban_kl_1</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">new_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;total_mua_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">market</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;mua_kl_1</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  
  <span class="c1"># get Gia KL</span>
  <span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;Gia KL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">market</span><span class="p">[</span><span class="s1">&#39;Gia KL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="n">new_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">market</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


  <span class="n">gttb</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">new_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;gttb&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Gia KL&#39;</span><span class="p">]</span>
  <span class="n">mua_ban</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">new_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gttb</span><span class="p">]</span>

  <span class="c1"># Group by minute</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="n">gttb</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">new_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">new_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">new_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">minute</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">result</span><span class="p">,</span><span class="n">new_df</span><span class="p">[</span><span class="n">mua_ban</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">new_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> 
                                                      <span class="n">new_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span>
                                                      <span class="n">new_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">minute</span>
                                                      <span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  
  <span class="c1">#Set index in minute</span>
  <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">h</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">:00&#34;</span> <span class="k">for</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
  <span class="n">result</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>

  <span class="c1">#handle missing value</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">handle_null</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">result</span>
</code></pre></td></tr></table>
</div>
</div><p>R·ªìi gi·ªù transform r·ªìi ki·ªÉm tra l·∫°i s·ªë l∆∞·ª£ng quan s√°t ·ªü b·∫£ng m·ªõi th√¥i</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Check the length of new data</span>
<span class="nb">len</span><span class="p">(</span><span class="n">new_market</span><span class="p">)</span> <span class="c1"># --&gt; 5154</span>
</code></pre></td></tr></table>
</div>
</div><p>V·ªõi k·∫øt qu·∫£ m·ªõi, ch·ªâ c√≤n l·∫°i 5154 quan s√°t m√† th√¥i, khi r√∫t l·∫°i m·ªôt s·ªë l∆∞·ª£ng quan s√°t l·ªõn nh∆∞ v·∫≠y, ta s·∫Ω ph·∫£i ch·∫•p nh·∫≠n r·ªßi ro m·∫•t
ƒëi nhi·ªÅu th√¥ng tin v·ªÅ d·ªØ li·ªáu m√† c·ª• th·ªÉ l√† d·ªØ li·ªáu theo gi√¢y (c·ª© 10 gi√¢y c·∫≠p nh·∫≠t). Nh∆∞ng ƒë·ªïi l·∫°i, data s·∫Ω c√¥ ƒë·ªông h∆°n v√† b·ªõt nhi·ªÖu v√¨
v·ªõi s·ª± bi·∫øn ƒë·ªïi c·ªßa th·ªã tr∆∞·ªùng trong c·∫£ 1 th√°ng, s·ª± thay ƒë·ªïi c·ªßa c√°c tr∆∞·ªùng trong m·ªói 10 gi√¢y l√† qu√° nh·ªè v√† kh√¥ng ƒë√°ng k·ªÉ.</p>
<h3 id="data-scaling" class="headerLink">
    <a href="#data-scaling" class="header-mark"></a>Data Scaling</h3><p>Sau khi c√≥ b·ªô dataframe m·ªõi t·ªët h∆°n v√† s·∫°ch s·∫Ω, b∆∞·ªõc k·∫ø ti·∫øp s·∫Ω l√† scale l·∫°i d·ªØ li·ªáu v·ªÅ m·ªôt chu·∫©n ƒë·ªÉ tƒÉng hi·ªáu qu·∫£ c·ªßa c√°c thu·∫≠t to√°n h·ªçc m√°y</p>
<p>C√≥ m·ªôt s·ªë ph∆∞∆°ng ph√°p scale data nh∆∞: Standardization, Normalization,&hellip;</p>
<p>·ªû project n√†y, OG s·∫Ω d√πng ph∆∞∆°ng ph√°p <strong>Normalization</strong> ƒë·ªÉ scale data. Ph∆∞∆°ng ph√°p chu·∫©n h√≥a n√†y ƒë∆∞a t·ª∑ l·ªá d·ªØ li·ªáu t·ª´ ph·∫°m vi ban ƒë·∫ßu
v·ªÅ chu·∫©n ph·∫°m vi t·ª´ 0 ƒë·∫øn 1, gi√° tr·ªã ƒë∆∞·ª£c normalize theo c√¥ng th·ª©c sau:</p>
<p>$$ x' = \frac{x - min}{max - min} $$
V·ªõi $x$ l√† gi√° tr·ªã c·∫ßn ƒë∆∞·ª£c chu·∫©n h√≥a, $max$ v√† $min$ l√† l·∫ßn l∆∞·ª£t l√† gi√° tr·ªã l·ªõn nh·∫•t v√† nh·ªè nh·∫•t trong t·∫•t c·∫£ c√°c observations c·ªßa feature trong t·∫≠p d·ªØ li·ªáu.</p>
<p>Ta s·∫Ω d√πng <code>MinMaxScaler</code> c·ªßa <code>scikit-learn</code> trong t√°c v·ª• n√†y.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="c1"># Normalization data using libraries</span>
<span class="n">min_max</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">new_market</span><span class="o">.</span><span class="n">values</span>
<span class="n">X_std</span> <span class="o">=</span> <span class="n">min_max</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Data after scaling: &#39;</span><span class="p">)</span>
<span class="n">X_std</span>
<span class="c1"># array([[9.10048201e-01, 9.43990665e-01, 9.59215952e-01, ...,</span>
<span class="c1">#         1.31664615e-02, 1.45711006e-02, 2.90267046e-03],</span>
<span class="c1">#        [9.14492108e-01, 9.61493582e-01, 9.57989455e-01, ...,</span>
<span class="c1">#         1.42007963e-02, 1.10109072e-04, 3.64335188e-03],</span>
<span class="c1">#        [9.12286536e-01, 9.57992999e-01, 9.56950233e-01, ...,</span>
<span class="c1">#         3.58702686e-03, 1.43141794e-03, 4.40405173e-04],</span>
<span class="c1">#        ...,</span>
<span class="c1">#        [9.23665190e-01, 9.04317386e-01, 8.96622210e-01, ...,</span>
<span class="c1">#         1.22024151e-01, 3.04635100e-03, 2.10293470e-02],</span>
<span class="c1">#        [9.24218272e-01, 8.89565349e-01, 8.97159958e-01, ...,</span>
<span class="c1">#         1.05691866e-02, 1.13779375e-03, 2.88265204e-02],</span>
<span class="c1">#        [9.28532923e-01, 9.04317386e-01, 8.98196897e-01, ...,</span>
<span class="c1">#         8.84087818e-03, 3.67030241e-04, 7.79383700e-03]]</span>
</code></pre></td></tr></table>
</div>
</div><p>Nh∆∞ v·∫≠y l√† ƒë√£ chu·∫©n b·ªã ho√†n t·∫•t cho b∆∞·ªõc ti·∫øp theo r·ªìi. Ch√∫ng ta s·∫Ω b∆∞·ªõc v√†o thu·∫≠t to√°n ch√≠nh ƒë·∫ßu ti√™n trong project n√†y.</p>
<h2 id="principle-component-analysis-pca" class="headerLink">
    <a href="#principle-component-analysis-pca" class="header-mark"></a>Principle Component Analysis (PCA)</h2><p>Ch√∫ng ta ƒë√£ ƒëi qua vi·ªác ti·ªÅn x·ª≠ l√Ω d√†i ngo·∫±n t·ª´ cleaning, transforming ƒë·∫øn scaling. V·∫≠y c√¢u h·ªèi l√†: <strong>d·ªØ li·ªáu ƒë√£ s·∫µn s√†ng ƒë·ªÉ
√°p d·ª•ng cho c√°c m√¥ h√¨nh m√°y h·ªçc hay ch∆∞a ?</strong></p>
<p>C√¢u tr·∫£ l·ªùi cho tr∆∞·ªùng h·ª£p n√†y l√†: <strong>Ch∆∞a</strong>. T·∫°i sao v·∫≠y ? B·ªüi v√¨ t·∫≠p d·ªØ li·ªáu c·ªßa ch√∫ng ta c√≥ qu√° nhi·ªÅu features</p>
<div class="details admonition note">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw"></i>Feature c·ªßa t·∫≠p data l√† g√¨ ?<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">D√†nh cho b·∫°n ch∆∞a bi·∫øt, feature c·ªßa t·∫≠p data c√≤n ƒë∆∞·ª£c g·ªçi l√† c√°c tr∆∞·ªùng (hay field) c·ªßa t·∫≠p data ƒë√≥. ƒê√≥ l√† c√°c c·ªôt, m·ªói c·ªôt l√† m·ªôt &ldquo;t√≠nh ch·∫•t&rdquo; kh√°c nhau c·ªßa ƒë·ªëi t∆∞·ª£ng aka quan s√°t (observation) th∆∞·ªùng l√† c√°c h√†ng.</div>
        </div>
    </div>
<p>Hi·ªán t·∫°i c√≥ th·ªÉ th·∫•y cleaning data c·ªßa ch√∫ng ta c√≥ 91 features:</p>
<ul>
<li><strong>gttb_(c·ªï phi·∫øu)</strong>: 30 c·ªôt gi√° tr·ªã trung b√¨nh giao d·ªãch c·ªßa 30 c·ªï phi·∫øu trong 1 ph√∫t</li>
<li><strong>total_ban_(c·ªï phi·∫øu)</strong>: 30 c·ªôt t·ªïng kh·ªëi l∆∞·ª£ng b√°n c·ªßa 30 c·ªï phi·∫øu trong 1 ph√∫t</li>
<li><strong>total_mua_(c·ªï phi·∫øu)</strong>: 30 c·ªôt t·ªïng kh·ªëi l∆∞·ª£ng mua c·ªßa 30 c·ªï phi·∫øu trong 1 ph√∫t</li>
<li><strong>Gia_KL</strong>: 1 c·ªôt gi√° ph√°i sinh VN30 Index (label)</li>
</ul>
<p>V·ªõi s·ªë l∆∞·ª£ng feature l·ªõn nh∆∞ v·∫≠y, s·∫Ω v√¥ c√πng k√©m hi·ªáu qu·∫£ n·∫øu ngay l·∫≠p t·ª©c s·ª≠ d·ª•ng train cho c√°c m√¥ h√¨nh machine learning. Gi·∫£i ph√°p ·ªü ƒë√¢y
ch√≠nh l√† ta s·∫Ω gi·∫£m chi·ªÅu d·ªØ li·ªáu xu·ªëng m·ª©c v·ª´a ƒë·∫°t hi·ªáu nƒÉng t·ªët khi training m√† c≈©ng kh√¥ng l√†m m·∫•t qu√° nhi·ªÅu th√¥ng tin c·ªßa d·ªØ li·ªáu.</p>
<p>V√¢ng ƒë√∫ng v·∫≠y, ph∆∞∆°ng ph√°p OG mu·ªën gi·ªõi thi·ªáu ch√≠nh l√† <code>PCA</code> hay c√≤n ƒë∆∞·ª£c bi·∫øt v·ªõi t√™n vi·ªát h√≥a l√† <code>Ph√¢n t√≠ch th√†nh ph·∫ßn ch√≠nh</code>. M·ª•c ti√™u c·ªßa ph∆∞∆°ng ph√°p n√†y
l√† ƒë∆∞a b·ªô d·ªØ li·ªáu ban ƒë·∫ßu sang h·ªá t·ªça ƒë·ªô m·ªõi d·ª±a tr√™n c√°c th√†nh ph·∫ßn ch√≠nh. D·ªØ li·ªáu ·ªü h·ªá t·ªça ƒë·ªô m·ªõi c√≥ √≠t chi·ªÅu h∆°n nh∆∞ng v·∫´n gi·ªØ ƒë∆∞·ª£c nhi·ªÅu nh·∫•t th√¥ng tin c√≥ th·ªÉ,
t·ª´ ƒë√≥ gi√∫p tƒÉng t·ªëc ƒë·ªô t√≠nh to√°n v√† gi·∫£m ƒë·ªô ph·ª©c t·∫°p m√¥ h√¨nh h∆°n r·∫•t nhi·ªÅu.</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw"></i>N√≥i t√≥m t·∫Øt cho d·ªÖ hi·ªÉu<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">C∆° b·∫£n l√† ph∆∞∆°ng ph√°p n√†y ƒë∆∞a b·ªô data c·ªßa ta v√†o m·ªôt &ldquo;th·∫ø gi·ªõi song song&rdquo; c√≥ s·ªë chi·ªÅu m·ªõi √≠t h∆°n (chi·ªÅu aka features). B·∫°n c√≥ th·ªÉ hi·ªÉu nh∆∞ l√† nh√¨n d·ªØ li·ªáu c·ªßa m√¨nh ·ªü m·ªôt g√≥c kh√°c v·∫≠y.</div>
        </div>
    </div>
<p>·ªû ph·∫ßn n√†y ch√∫ng ta s·∫Ω s·ª≠ d·ª•ng ph∆∞∆°ng ph√°p n√†y th√¥ng qua s·ª± ph√¢n r√£ c·ªßa ma tr·∫≠n hi·ªáp ph∆∞∆°ng sai (Eigen decomposition of covariance matrix)</p>
<h3 id="eigenvector-v√†-eigenvalue" class="headerLink">
    <a href="#eigenvector-v%c3%a0-eigenvalue" class="header-mark"></a>EigenVector v√† EigenValue</h3><p>Ma tr·∫≠n hi·ªáp ph∆∞∆°ng sai ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a l√†:</p>
<p>$$ S = \frac{1}{N}\hat{X}^T\hat{X} $$</p>
<p>V·ªõi $\hat{X} = X - \hat{x}1^T$ l√† zero-corrected data hay d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c chu·∫©n ho√°.</p>
<p>Ta s·∫Ω vi·∫øt h√†m <strong>get_eigenpairs()</strong> ƒë·ªÉ t√¨m c√°c vector ri√™ng v√† gi√° tr·ªã ri√™ng c·ªßa ma tr·∫≠n hi·ªáp ph∆∞∆°ng sai:</p>
<p>$$ Su_i = \lambda_iu_i $$</p>
<p>Trong ƒë√≥: c√°c $(\lambda_i,u_i)$ l√† c√°c c·∫∑p tr·ªã ri√™ng (kh√¥ng √¢m) v√† vector ri√™ng c·ªßa ma tr·∫≠n hi·ªáp ph∆∞∆°ng sai $S$</p>
<p><strong>T·∫°i sao l·∫°i c·∫ßn t√¨m c√°c vector ri√™ng v√† gi√° tr·ªã ri√™ng c·ªßa ma tr·∫≠n hi·ªáp ph∆∞∆°ng sai ?</strong>
Vi·ªác s·ª≠ d·ª•ng c√°c gi√° tr·ªã ri√™ng ƒë·ªÉ ƒë√°nh gi√° s·ª± quan tr·ªçng c·ªßa m·ªói th√†nh ph·∫ßn ch√≠nh ƒë∆∞·ª£c t·∫°o ra t·ª´ vi·ªác gi·∫£m chi·ªÅu d·ªØ li·ªáu.
C√°c gi√° tr·ªã ri√™ng c√†ng l·ªõn th√¨ th√†nh ph·∫ßn ch√≠nh t∆∞∆°ng ·ª©ng c√†ng quan tr·ªçng.
C√°c vector ri√™ng t∆∞∆°ng ·ª©ng v·ªõi c√°c gi√° tr·ªã ri√™ng n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ x√°c ƒë·ªãnh h∆∞·ªõng c·ªßa c√°c th√†nh ph·∫ßn ch√≠nh.</p>
<ul>
<li><strong>Gi√° tr·ªã ri√™ng (Eigenvalues $\lambda_i$)</strong>: C√°c h·ªá s·ªë ƒë∆∞·ª£c g·∫Øn v·ªõi c√°c vector ri√™ng, cung c·∫•p cho ƒë·ªô l·ªõn c·ªßa tr·ª•c. Trong tr∆∞·ªùng h·ª£p n√†y, ch√∫ng l√† th∆∞·ªõc ƒëo hi·ªáp ph∆∞∆°ng sai c·ªßa d·ªØ li·ªáu.</li>
<li><strong>Vector ri√™ng (EigenVector $u_i$)</strong>:C√°c vector (kh√°c 0) kh√¥ng thay ƒë·ªïi h∆∞·ªõng khi √°p d·ª•ng b·∫•t k·ª≥ ph√©p bi·∫øn ƒë·ªïi tuy·∫øn t√≠nh (linear transformation) n√†o, n√≥ ch·ªâ thay ƒë·ªïi theo h·ªá s·ªë v√¥ h∆∞·ªõng.</li>
<li><strong>H√†m s·∫Øp x·∫øp c√°c vector ri√™ng (Sort eigenvalues)</strong>: B·∫±ng c√°ch s·∫Øp x·∫øp c√°c vector ri√™ng theo th·ª© t·ª± c·ªßa gi√° tr·ªã ri√™ng, ta c√≥ th·ªÉ ch·ªçn ra c√°c vector ri√™ng c√≥ gi√° tr·ªã ri√™ng l·ªõn nh·∫•t ƒë·ªÉ x√¢y d·ª±ng c√°c th√†nh ph·∫ßn ch√≠nh c·ªßa d·ªØ li·ªáu (ƒë√≥ng g√≥p nhi·ªÅu nh·∫•t v√†o vi·ªác gi·∫£i th√≠ch s·ª± bi·∫øn thi√™n c·ªßa d·ªØ li·ªáu). C√°c th√†nh ph·∫ßn ch√≠nh n√†y c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ t√°i c·∫•u tr√∫c d·ªØ li·ªáu ban ƒë·∫ßu m√† v·∫´n gi·ªØ ƒë∆∞·ª£c ƒë·ªô gi·ªëng nhau c·ªßa c√°c ƒëi·ªÉm d·ªØ li·ªáu ban ƒë·∫ßu.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">get_eigenpairs</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
  <span class="s1">&#39;&#39;&#39;
</span><span class="s1">  Input: X: np.array (init matrix)
</span><span class="s1">  return eigenpairs containing eigenvalues and eigenvectors of covariance matrix
</span><span class="s1">  &#39;&#39;&#39;</span>
  <span class="c1"># Covariance matrix</span>
  <span class="n">cov_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

  <span class="c1"># Eigenvalues and Eigenvectors</span>
  <span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">cov_mat</span><span class="p">)</span>

  <span class="c1"># Sort eigenvalues</span>
  <span class="n">epairs</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">eval</span><span class="p">),</span> <span class="n">evec</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="nb">eval</span><span class="p">,</span> <span class="n">evec</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span><span class="o">.</span><span class="n">T</span><span class="p">)]</span>
  <span class="n">epairs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">epairs</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">pair</span><span class="p">:</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">reverse</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">epairs</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="cumulative-sum-of-components" class="headerLink">
    <a href="#cumulative-sum-of-components" class="header-mark"></a>Cumulative Sum of Components</h3><p>T√≠nh t·ªïng t√≠ch l≈©y c·ªßa c√°c th√†nh ph·∫ßn trong PCA (Cumulative Sum of Explained Variance) ƒë·ªÉ x√°c ƒë·ªãnh t·ªïng ph·∫ßn trƒÉm ph∆∞∆°ng sai ƒë∆∞·ª£c gi·∫£i th√≠ch b·ªüi c√°c th√†nh ph·∫ßn ƒë∆∞·ª£c gi·ªØ l·∫°i trong m√¥ h√¨nh PCA.
$$ r_K = \frac{\sum^K_{i=1}\lambda_i}{\sum^D_{j=1}\lambda_j} $$
l√† l∆∞·ª£ng th√¥ng tin ƒë∆∞·ª£c gi·ªØ l·∫°i khi s·ªë chi·ªÅu d·ªØ li·ªáu m·ªõi sau PCA l√† K.</p>
<ul>
<li>H√†m findNumVec() th·ª±c hi·ªán vi·ªác l·∫•y c√°c gi√° tr·ªã ri√™ng t·ª´ danh s√°ch c√°c eigenpairs v√† chuy·ªÉn ƒë·ªïi ch√∫ng th√†nh m·ªôt m·∫£ng numpy. Sau ƒë√≥, n√≥ t√≠nh t·ªïng t√≠ch l≈©y c·ªßa c√°c gi√° tr·ªã ri√™ng, s·ª≠ d·ª•ng h√†m np.cumsum () chu·∫©n h√≥a t·ªïng c·ªßa ch√∫ng =&gt; cho ra m·ªôt danh s√°ch c√°c gi√° tr·ªã (trong kho·∫£ng t·ª´ 0 ƒë·∫øn 1) ƒë·∫°i di·ªán cho t·ª∑ l·ªá ph·∫ßn trƒÉm ph∆∞∆°ng sai ƒë∆∞·ª£c gi·∫£i th√≠ch b·ªüi m·ªói th√†nh ph·∫ßn ch√≠nh.</li>
<li>Sau ƒë√≥, h√†m l·∫∑p qua danh s√°ch t·ªïng t√≠ch l≈©y v√† t√¨m ch·ªâ m·ª•c c·ªßa gi√° tr·ªã ƒë·∫ßu ti√™n l·ªõn h∆°n ho·∫∑c b·∫±ng t·ª∑ l·ªá ph·∫ßn trƒÉm ph∆∞∆°ng sai mong mu·ªën ƒë∆∞·ª£c gi·∫£i th√≠ch. Ch·ªâ s·ªë n√†y ƒë·∫°i di·ªán cho s·ªë l∆∞·ª£ng th√†nh ph·∫ßn ch√≠nh c·∫ßn thi·∫øt ƒë·ªÉ gi·∫£i th√≠ch t·ª∑ l·ªá ph·∫ßn trƒÉm ph∆∞∆°ng sai ƒë√≥, v√¨ v·∫≠y h√†m tr·∫£ v·ªÅ gi√° tr·ªã n√†y c·ªông v·ªõi 1 (v√¨ l·∫≠p ch·ªâ m·ª•c Python b·∫Øt ƒë·∫ßu t·ª´ 0).</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">findNumVec</span><span class="p">(</span><span class="n">eigenpairs</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">percent</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">):</span>
    <span class="s1">&#39;&#39;&#39;
</span><span class="s1">    Find number of principal components (eigenvectors) 
</span><span class="s1">    -&gt; return the number of principal components when total accumulate &gt;= percent
</span><span class="s1">    &#39;&#39;&#39;</span>

    <span class="c1"># Get eigenvalues </span>
    <span class="n">eigenvals</span> <span class="o">=</span> <span class="p">[</span><span class="n">eigenval</span> <span class="k">for</span> <span class="p">(</span><span class="n">eigenval</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">eigenpairs</span><span class="p">]</span>
    <span class="n">eigenvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eigenvals</span><span class="p">)</span>
    
    <span class="c1"># Cumulative sum and calculate percent</span>
    <span class="n">cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">eigenvals</span><span class="p">)</span>
    <span class="n">cumsum</span> <span class="o">/=</span> <span class="n">cumsum</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Find number of principal components that accumulate &gt;= percent</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cumsum</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;=</span> <span class="n">percent</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></td></tr></table>
</div>
</div><p>Ta s·∫Ω th·ª≠ t√¨m xem s·ªë th√†nh ph·∫ßn ch√≠nh c·∫ßn ƒë·ªÉ gi·ªØ ƒë∆∞·ª£c 80% d·ªØ li·ªáu:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="nb">print</span><span class="p">(</span><span class="n">findNumVec</span><span class="p">(</span><span class="n">epairs</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">))</span> <span class="c1"># --&gt; 28</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="scree-chart" class="headerLink">
    <a href="#scree-chart" class="header-mark"></a>Scree Chart</h3><p>Ta s·∫Ω v·∫Ω m·ªôt bi·ªÉu ƒë·ªì th·ªÉ hi·ªán quan h·ªá c·ªßa s·ªë l∆∞·ª£ng th√†nh ph·∫ßn ch√≠nh v√† ph·∫ßn trƒÉm ph∆∞∆°ng sai gi·∫£i th√≠ch t√≠ch l≈©y</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">screeplot</span><span class="p">(</span><span class="n">eigenpairs</span><span class="p">):</span>
    <span class="s1">&#39;&#39;&#39;
</span><span class="s1">    Scree plot
</span><span class="s1">    &#39;&#39;&#39;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">eigenvals</span> <span class="o">=</span> <span class="p">[</span><span class="n">eigenval</span> <span class="k">for</span> <span class="p">(</span><span class="n">eigenval</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">eigenpairs</span><span class="p">]</span>
    <span class="n">eigenvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eigenvals</span><span class="p">)</span>
    <span class="n">cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">eigenvals</span><span class="p">)</span> <span class="c1"># extracts the eigenvalues from the eigenpairs and calculates their cumulative sum</span>
    <span class="n">cumsum</span> <span class="o">/=</span> <span class="n">cumsum</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">name</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PCA </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cumsum</span><span class="p">))]</span>

    <span class="c1"># line plot</span>
    <span class="c1"># the eigenvalues are plotted against the number of principal components</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">eigenvals</span><span class="p">)),</span> <span class="n">eigenvals</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Eigenvalue&#39;</span><span class="p">)</span> 
    
    <span class="c1"># the cumulative proportion of the variance explained by each component is plotted against the number of principal components</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cumsum</span><span class="p">)),</span> <span class="n">cumsum</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Cumulative propotion&#39;</span><span class="p">)</span>
    
    <span class="c1"># y axis label</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Eigen values&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cumulative explained variance&#39;</span><span class="p">)</span>

    <span class="c1"># item legend</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># grid</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="c1"># title</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">supxlabel</span><span class="p">(</span><span class="s1">&#39;Number of components&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1">#print the cumsum of eigenvalues</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cumsum</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Cumulative total&#39;</span><span class="p">],</span> <span class="n">index</span> <span class="o">=</span> <span class="n">name</span><span class="p">))</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="sa">f</span><span class="s2">&#34;PC </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">var</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&#34;</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cumsum</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">result</span>
<span class="n">pca_scree</span> <span class="o">=</span> <span class="n">screeplot</span><span class="p">(</span><span class="n">epairs</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="/img/stock-scree.png" title="Scree plot" data-thumbnail="/img/stock-scree.png" data-sub-html="<h2>Scree plot</h2><p>Scree plot</p>">
        <img
            
            loading="lazy"
            src="/img/stock-scree.png"
            srcset="/img/stock-scree.png, /img/stock-scree.png 1.5x, /img/stock-scree.png 2x"
            sizes="auto"
            alt="Scree plot" height="726"  width="667" >
    </a><figcaption class="image-caption">Scree plot</figcaption>
    </figure></p>
<p><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw"></i>Gi·∫£i th√≠ch<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>ƒê∆∞·ªùng c·ªßa gi√° tr·ªã ri√™ng m√†u xanh n∆∞·ªõc bi·ªÉn tr√™n bi·ªÉu ƒë·ªì cho ta bi·∫øt ƒë·ªô l·ªõn c·ªßa m·ªói th√†nh ph·∫ßn ch√≠nh v√† t·∫ßm quan tr·ªçng c·ªßa ch√∫ng trong gi·∫£i th√≠ch s·ª± bi·∫øn thi√™n c·ªßa d·ªØ li·ªáu.
N·∫øu gi√° tr·ªã ri√™ng c·ªßa m·ªôt th√†nh ph·∫ßn ch√≠nh l√† l·ªõn, th√¨ th√†nh ph·∫ßn ƒë√≥ c√≥ t·∫ßm quan tr·ªçng cao trong vi·ªác gi·∫£i th√≠ch s·ª± bi·∫øn thi√™n c·ªßa d·ªØ li·ªáu.</p>
<p>ƒê∆∞·ªùng m√†u xanh l√° th·ªÉ hi·ªán t·ªïng t√≠ch l≈©y cho ta bi·∫øt t·ªïng ph·∫ßn trƒÉm ƒë·ªô l·ªõn c·ªßa s·ª± bi·∫øn thi√™n c·ªßa d·ªØ li·ªáu m√† c√°c th√†nh ph·∫ßn ch√≠nh c√≥ th·ªÉ gi·∫£i th√≠ch.</p>
</div>
        </div>
    </div>
D·ª±a v√†o bi·ªÉu ƒë·ªì tr√™n c√≥ th·ªÉ nh·∫≠n th·∫•y n·∫øu ch·ªâ c√≥ 2 chi·ªÅu, ta ch·ªâ gi·ªØ ƒë∆∞·ª£c kho·∫£ng 37% d·ªØ li·ªáu ban ƒë·∫ßu.</p>
<h3 id="visualize-pca" class="headerLink">
    <a href="#visualize-pca" class="header-mark"></a>Visualize PCA</h3><p>B√¢y gi·ªù, ta s·∫Ω th·ª±c hi·ªán chi·∫øu d·ªØ li·ªáu ban ƒë·∫ßu ƒë√£ chu·∫©n h√≥a $\hat{X}$ xu·ªëng kh√¥ng gian con t√¨m ƒë∆∞·ª£c v√† l·∫•y ra ma tr·∫≠n c√°c th√†nh ph·∫ßn ch√≠nh ƒë·ªÉ ti·∫øp t·ª•c c√¥ng vi·ªác ph√¢n t√≠ch v√† x√¢y d·ª±ng m√¥ h√¨nh.</p>
<p>H√†m <strong>getPC()</strong> tr·∫£ v·ªÅ m·ªôt ma tr·∫≠n c√°c th√†nh ph·∫ßn ch√≠nh t·ª´ ma tr·∫≠n ban ƒë·∫ßu, d·ª±a tr√™n s·ªë l∆∞·ª£ng th√†nh ph·∫ßn ƒë√£ cho ho·∫∑c s·ªë l∆∞·ª£ng th√†nh ph·∫ßn gi·ªØ ƒë∆∞·ª£c 80% d·ªØ li·ªáu (n·∫øu num_components kh√¥ng ƒë∆∞·ª£c ƒë∆∞a ra).</p>
<p>Ma tr·∫≠n tr·ªçng s·ªë $W$ l√† ma tr·∫≠n chuy·ªÉn ƒë·ªïi tuy·∫øn t√≠nh ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu g·ªëc v√†o kh√¥ng gian m·ªõi, trong ƒë√≥ m·ªói th√†nh ph·∫ßn ch√≠nh ƒë∆∞·ª£c s·∫Øp x·∫øp theo ƒë·ªô quan tr·ªçng gi·∫£m d·∫ßn. C·ª• th·ªÉ, m·ªói c·ªôt c·ªßa ma tr·∫≠n
$W$ l√† m·ªôt vector ri√™ng chu·∫©n h√≥a t∆∞∆°ng ·ª©ng v·ªõi c√°c gi√° tr·ªã ri√™ng c·ªßa ma tr·∫≠n hi·ªáp ph∆∞∆°ng sai $s$.</p>
<p>Th·ª±c hi·ªán vi·ªác nh√¢n ma tr·∫≠n $W$ v·ªõi ho√°n v·ªã c·ªßa ma tr·∫≠n ƒë√£ chu·∫©n h√≥a $\hat{X}$ (init_matrix). Ma tr·∫≠n k·∫øt qu·∫£ sau ƒë√≥ ti·∫øp t·ª•c ƒë∆∞·ª£c ho√°n v·ªã ƒë·ªÉ ph√π h·ª£p v·ªõi h√¨nh d·∫°ng ban ƒë·∫ßu c·ªßa init_matrix v√† tr·∫£ v·ªÅ k·∫øt qu·∫£.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">getPC</span><span class="p">(</span><span class="n">eigenpairs</span><span class="p">,</span> <span class="n">init_matrix</span><span class="p">,</span> <span class="n">num_components</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="s1">&#39;&#39;&#39;
</span><span class="s1">    Return matrix of principal components from init_matrix
</span><span class="s1">    &#39;&#39;&#39;</span>
    <span class="c1"># default num_components = number which to keep 80% data</span>
    <span class="k">if</span> <span class="n">num_components</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">num_components</span> <span class="o">=</span> <span class="n">findNumVec</span><span class="p">(</span><span class="n">eigenpairs</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
    
    <span class="c1"># extracts the eigen vectors corresponding to the top num_components eigenvalues from the eigenpairs list</span>
    <span class="n">eigenvecs</span> <span class="o">=</span> <span class="p">[</span><span class="n">eigenvec</span> <span class="k">for</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">eigenvec</span><span class="p">)</span> <span class="ow">in</span> <span class="n">eigenpairs</span><span class="p">[:</span><span class="n">num_components</span><span class="p">]]</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">T</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">eigenvecs</span><span class="p">])</span> <span class="c1"># stacks the eigen vectors into a weight matrix W</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">W</span> <span class="o">@</span> <span class="n">init_matrix</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

<span class="n">X_pca</span> <span class="o">=</span> <span class="n">getPC</span><span class="p">(</span><span class="n">epairs</span><span class="p">,</span> <span class="n">X_std</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>V·∫≠y l√† ta ƒë√£ gi·∫£m ƒë∆∞·ª£c ƒë·ªô ph·ª©c t·∫°p cho b·ªô d·ªØ li·ªáu kh√° &ldquo;nh·ªçc nh·∫±n&rdquo; n√†y. H√£y tr·ª±c quan h√≥a l√™n bi·ªÉu ƒë·ªì ƒë·ªÉ c√≥ m·ªôt g√≥c nh√¨n c·ª• th·ªÉ v√† r√µ r√†ng h∆°n.</p>
<p>Bi·ªÉu ƒë·ªì scatter plot sau khi PCA c√≥ th·ªÉ gi√∫p cho ch√∫ng ta nh√¨n th·∫•y c√°ch d·ªØ li·ªáu ƒë∆∞·ª£c ph√¢n b·ªë tr√™n c√°c th√†nh ph·∫ßn ch√≠nh (principal components) v√† ki·ªÉm tra xem li·ªáu ch√∫ng ta c√≥ th·ªÉ t√¨m th·∫•y c√°c cluster ho·∫∑c pattern n√†o trong d·ªØ li·ªáu.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_pca</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_pca</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;PC1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PC2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Visualizing data through PCA&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="/img/stock-pcavisual.png" title="Visualizing data via PCA" data-thumbnail="/img/stock-pcavisual.png" data-sub-html="<h2>Visualizing data via PCA</h2><p>Visualizing data via PCA</p>">
        <img
            
            loading="lazy"
            src="/img/stock-pcavisual.png"
            srcset="/img/stock-pcavisual.png, /img/stock-pcavisual.png 1.5x, /img/stock-pcavisual.png 2x"
            sizes="auto"
            alt="Visualizing data via PCA" height="706"  width="928" >
    </a><figcaption class="image-caption">Visualizing data via PCA</figcaption>
    </figure></p>
<p>Okayy d·ª±a v√†o bi·ªÉu ƒë·ªì tr√™n, c≈©ng c√≥ th·ªÉ th·∫•y l√† d·ªØ li·ªáu ·ªü kh√¥ng gian m·ªõi ƒë√£ ph√¢n t√°ch kh√° r√µ r√†ng r·ªìi. ƒêi·ªÅu n√†y nghƒ©a l√† ph∆∞∆°ng ph√°p PCA ƒë√£
gi·∫£m s·ªë chi·ªÅu c·ªßa d·ªØ li·ªáu m·ªôt c√°ch hi·ªáu qu·∫£. B∆∞·ªõc ti·∫øp theo ch√≠nh l√† √°p v√†o m√¥ h√¨nh <code>K-Means</code> ƒë·ªÉ ph√¢n c·ª•m v√† t√¨m pattern. Ch√∫ng ta s·∫Ω c√πng chi·∫øn ti·∫øp ·ªü ph·∫ßn 2 nh√©</p>
<h2 id="to-be-continue" class="headerLink">
    <a href="#to-be-continue" class="header-mark"></a>To be Continue</h2><p>Ch√∫ng ta ƒë√£ th·ª±c hi·ªán c√°c b∆∞·ªõc ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu v√† sau ƒë√≥ l√† th·ª±c hi·ªán PCA ƒë·ªÉ gi·∫£m chi·ªÅu d·ªØ li·ªáu m·ªôt c√°ch hi·ªáu qu·∫£. B√†i sau ph·∫ßn 2, OG s·∫Ω
th·ª±c hi·ªán training m√¥ h√¨nh K-means clustering v√† cu·ªëi c√πng l√† ph√¢n t√≠ch d·ªØ li·ªáu ch·ª©ng kho√°ng.</p>
<p>ƒê√¢y l√† ki·∫øn th·ª©c t√≠ch g√≥p t·ª´ nhi·ªÅu ngu·ªìn v√† nghi√™n c·ª©u c·ªßa nh√≥m OG, t·∫•t nhi√™n kh√¥ng th·ªÉ tr√°nh kh·ªèi sai s√≥t. Hy v·ªçng b√†i vi·∫øt l·∫ßn n√†y th√∫ v·ªã v√† gi√∫p b·∫°n ƒë·ªçc th∆∞ gi√£n, tham kh·∫£o.</p>
<p>-Mew-</p>
<hr>
<h1 id="related" class="headerLink">
    <a href="#related" class="header-mark"></a>Related</h1>
<div class="showcase-box column-2">
    <div class="showcase-image">
        <a href=/football_etl/><img
        
        loading="lazy"
        src="/img/projects-football.jpg"
        srcset="/img/projects-football.jpg, /img/projects-football.jpg 1.5x, /img/projects-football.jpg 2x"
        sizes="auto"
        alt="Football ETL Analysis"
        title="Football ETL Analysis" height="200"   width="400" ></a>
    </div>
    <h2 class="showcase-title">
        <a href=/football_etl/>Football ETL Analysis</a>
    </h2>
    <p class="showcase-summary">
        A Data Engineer project building pipeline to analyze football data
    </p>
    <a class="showcase-link" href=/football_etl/>
        Read more...
    </a>
</div>

<div class="showcase-box column-2">
    <div class="showcase-image">
        <a href=/stock_analysis_2/><img
        
        loading="lazy"
        src="/img/projects-stock.jpg"
        srcset="/img/projects-stock.jpg, /img/projects-stock.jpg 1.5x, /img/projects-stock.jpg 2x"
        sizes="auto"
        alt="Stock Analysis P2"
        title="Stock Analysis P2" height="200"   width="400" ></a>
    </div>
    <h2 class="showcase-title">
        <a href=/stock_analysis_2/>Stock Analysis P2</a>
    </h2>
    <p class="showcase-summary">
        Stock Analysis using PCA and K-means
    </p>
    <a class="showcase-link" href=/stock_analysis_2/>
        Read more...
    </a>
</div>
</div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 31 Aug 2023</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share"><button title="Share on Facebook" data-sharer="facebook" data-url="https://phonghuynh.netlify.app/stock_analysis/" data-hashtag="Machine learning"><span class="fab fa-facebook-square fa-fw"></span></button><button title="Share on Linkedin" data-sharer="linkedin" data-url="https://phonghuynh.netlify.app/stock_analysis/"><span class="fab fa-linkedin fa-fw"></span></button></div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/machine-learning/">Machine learning</a>,&nbsp;<a href="/tags/math/">math</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/football_etl_2/" class="prev" rel="prev" title="Football ETL Analysis P2"><i class="fas fa-angle-left fa-fw"></i>Football ETL Analysis P2</a>
            <a href="/stock_analysis_2/" class="next" rel="next" title="Stock Analysis P2">Stock Analysis P2<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank" rel="noopener noreferrer">OG</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div></footer></div>

    <div id="fixed-buttons"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="Back to Top">
            <i class="fas fa-arrow-up fa-fw"></i>
        </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
            <i class="fas fa-comment fa-fw"></i>
        </a>
    </div><div class="assets"><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/katex/copy-tex.min.css">
        <noscript><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"></noscript><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"sharerjs":true,"table":{"sort":true}};</script><script type="text/javascript" src="/lib/tablesort/tablesort.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js" defer></script><script type="text/javascript" src="/lib/katex/auto-render.min.js" defer></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js" defer></script><script type="text/javascript" src="/lib/katex/mhchem.min.js" defer></script><script type="text/javascript" src="/js/katex.min.js" defer></script><script type="text/javascript" src="/js/theme.min.js" defer></script></div>
</body>

</html>