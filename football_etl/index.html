

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title>Football ETL Analysis - OG Home</title><meta name="Description" content="A Data Engineer project building pipeline to analyze football data"><meta property="og:title" content="Football ETL Analysis" />
<meta property="og:description" content="A Data Engineer project building pipeline to analyze football data" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://phonghuynh.netlify.app/football_etl/" /><meta property="og:image" content="https://github.com/PhongHuynh0394/Football_ETL_Analysis/raw/master/images/ETL.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-31T14:46:50+07:00" />
<meta property="article:modified_time" content="2023-07-31T14:46:50+07:00" /><meta property="og:site_name" content="OG Home" />
<meta property="og:see_also" content="https://phonghuynh.netlify.app/football_etl_2/" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://github.com/PhongHuynh0394/Football_ETL_Analysis/raw/master/images/ETL.png"/>

<meta name="twitter:title" content="Football ETL Analysis"/>
<meta name="twitter:description" content="A Data Engineer project building pipeline to analyze football data"/>
<meta name="application-name" content="OG">
<meta name="apple-mobile-web-app-title" content="OG">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://phonghuynh.netlify.app/football_etl/" /><link rel="next" href="https://phonghuynh.netlify.app/football_etl_2/" />
<link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/color.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/fontawesome-free/all.min.css">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/animate/animate.min.css">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Football ETL Analysis",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/phonghuynh.netlify.app\/football_etl\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/phonghuynh.netlify.app\/img\/oggy.png",
                            "width":  240 ,
                            "height":  240 
                        }],"genre": "posts","keywords": "data engineer, etl, dagster, docker, Tech, data pipeline, streamlit, MySQL, PostgreSQL, MinIO","wordcount":  1697 ,
        "url": "https:\/\/phonghuynh.netlify.app\/football_etl\/","datePublished": "2023-07-31T14:46:50+07:00","dateModified": "2023-07-31T14:46:50+07:00","publisher": {
            "@type": "Organization",
            "name": "OG Page","logo": "https:\/\/phonghuynh.netlify.app\/favicon.icon"},"authors": [{
                        "@type": "Person",
                        "name": "OG"                    
                    }],"description": "A Data Engineer project building pipeline to analyze football data"
    }
    </script><script src="//instant.page/5.2.0" defer type="module" integrity="sha384-jnZyxPjiipYXnSU0ygqeac2q7CVYMbh84q0uHVRRxEtvFPiQYbXWUorga2aqZJ0z"></script>
</head>

<body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">
        function setTheme(theme) {document.body.setAttribute('theme', theme); document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark'); window.theme = theme;   window.isDark = window.theme !== 'light' }
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('auto' === 'light' || 'auto' === 'dark' || 'auto' === 'black') setTheme('auto'), saveTheme('auto'); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let metaColors = {'light': '#f8f8f8','dark': '#252627','black': '#000000'}
        getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
        window.switchThemeEventSet = new Set()
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="OG Home">OG Home</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/blogs/" title="OG&#39;s blogs"> Blogs </a><a class="menu-item" href="/projects/" title="OG&#39;s Projects"> Projects </a><a class="menu-item" href="/tags/" title="Tags of blogs"> Tags </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://drive.google.com/file/d/1jIJxzyFMc7zy78tsBJc7ShFyV8sQTBS7/view?usp=sharing" title="Resume" rel="noopener noreferrer" target="_blank"> Resume üîó </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="OG Home">OG Home</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/blogs/" title="OG&#39;s blogs">Blogs</a><a class="menu-item" href="/projects/" title="OG&#39;s Projects">Projects</a><a class="menu-item" href="/tags/" title="Tags of blogs">Tags</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://drive.google.com/file/d/1jIJxzyFMc7zy78tsBJc7ShFyV8sQTBS7/view?usp=sharing" title="Resume" rel="noopener noreferrer" target="_blank">Resume üîó</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
            <div class="container"><div class="toc" id="toc-auto">
        <h2 class="toc-title">Contents</h2>
        <div class="toc-content always-active" id="toc-content-auto"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduce">Introduce</a></li>
    <li><a href="#set-up">Set up</a>
      <ul>
        <li><a href="#minio">MinIO</a></li>
        <li><a href="#mysql">MySQL</a></li>
        <li><a href="#postgesql">PostgeSQL</a></li>
        <li><a href="#dagster">Dagster</a>
          <ul>
            <li><a href="#dagit">Dagit</a></li>
            <li><a href="#dagster-deamon">Dagster Deamon</a></li>
          </ul>
        </li>
        <li><a href="#pipeline">Pipeline</a></li>
        <li><a href="#streamlit">Streamlit</a></li>
        <li><a href="#ho√†n-ch·ªânh-setup">Ho√†n ch·ªânh setup</a></li>
      </ul>
    </li>
    <li><a href="#to-be-continue">To be Continue</a></li>
  </ul>
</nav></div>
    </div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Football ETL Analysis</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><span class='author'><span class="author fas fa-user-circle fa-fw"></span><span class='screen-reader-text'>  </span><a href='https://phonghuynh.netlify.app/authors/og'>OG</a></span>
                </span>&nbsp;<span class="post-category">included in </span>&nbsp;<span class="post-category">category <a href="/categories/projects/"><i class="far fa-folder fa-fw"></i>projects</a></span>&nbsp;<span class="post-category">and</span>&nbsp;<span class="post-series">series <a href="/series/football-etl/"><i class="far fa-list-alt fa-fw"></i>Football ETL</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="31 Jul 2023">31 Jul 2023</time>&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;8 minutes&nbsp;</div>
        </div><div class="details series-nav open">
                                <div class="details-summary series-title">
                                    <span>Series - Football ETL</span>
                                    <span><i class="details-icon fas fa-angle-right"></i></span>
                                </div>
                                <div class="details-content series-content">
                                    <nav>
                                        <ul><li><span class="active">Football ETL Analysis</span></li>
                                                    <li><a href="/football_etl_2/">Football ETL Analysis P2</a></li></ul>
                                    </nav>
                                </div>
                            </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduce">Introduce</a></li>
    <li><a href="#set-up">Set up</a>
      <ul>
        <li><a href="#minio">MinIO</a></li>
        <li><a href="#mysql">MySQL</a></li>
        <li><a href="#postgesql">PostgeSQL</a></li>
        <li><a href="#dagster">Dagster</a>
          <ul>
            <li><a href="#dagit">Dagit</a></li>
            <li><a href="#dagster-deamon">Dagster Deamon</a></li>
          </ul>
        </li>
        <li><a href="#pipeline">Pipeline</a></li>
        <li><a href="#streamlit">Streamlit</a></li>
        <li><a href="#ho√†n-ch·ªânh-setup">Ho√†n ch·ªânh setup</a></li>
      </ul>
    </li>
    <li><a href="#to-be-continue">To be Continue</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p><strong>Source</strong>
<a target="_blank" href="https://github.com/PhongHuynh0394/Football_ETL_Analysis" title="PhongHuynh0394" class="friend-link" rel="noopener noreferrer">
    <div class="friend-link-div">
        <div class="friend-link-avatar"><img
        
        loading="lazy"
        src="/img/github-logo.png"
        srcset="/img/github-logo.png, /img/github-logo.png 1.5x, /img/github-logo.png 2x"
        sizes="auto"
        alt="/img/github-logo.png"
        title="/img/github-logo.png" height="560"   width="560" ></div>
        <div class="friend-link-info">
            <div class="friend-name-div">
                <i class="fas fa-user-circle fa-fw"></i>
                <i class="friend-name">PhongHuynh0394</i>
            </div>
            <p class="friend-bio">Football_ETL_Analysis</p>
        </div>
    </div>
</a></p>
<h2 id="introduce" class="headerLink">
    <a href="#introduce" class="header-mark"></a>Introduce</h2><p>Trong project n√†y, OG s·∫Ω build end-to-end ETL data pipeline ho√†n ch·ªânh ƒë·ªÉ ph√¢n t√≠ch football data t·ª´ Kaggle v·ªõi data pipeline nh∆∞ sau:</p>
<figure><img src="https://github.com/PhongHuynh0394/Football_ETL_Analysis/raw/master/images/ETL.png"/><figcaption>
            <h4>Data Pipeline</h4>
        </figcaption>
</figure>

<p>C√°c b∆∞·ªõc c·ª• th·ªÉ:</p>
<ol>
<li><strong>Set up</strong>: D√πng <code>Docker</code> t·∫°o container v√† c√°c images c·∫ßn thi·∫øt cho pipeline, trong ƒë√≥ c√≥ c·∫£ <code>Dagster</code> d√πng x√¢y d·ª±ng pipeline.</li>
<li><strong>Chu·∫©n b·ªã data source</strong>: load c√°c file csv (c√≥ ƒë∆∞·ª£c t·ª´ Kaggle) v√†o <code>MySQL</code> nh·∫±m m·ª•c ƒë√≠ch l∆∞u tr·ªØ raw data (m√¥ ph·ªèng source data)</li>
<li><strong>Extract</strong>: L·∫•y data t·ª´ <code>MySQL</code> v√† load v√†o <code>MinIO</code> chu·∫©n b·ªã cho b∆∞·ªõc transform</li>
<li><strong>Transform</strong>: S·ª≠ d·ª•ng <code>Pandas</code> ƒë·ªÉ truy v·∫•n c√°c file t·ª´ <code>MinIO</code></li>
<li><strong>Load</strong>: Cleaned v√† transformed data ƒë∆∞·ª£c load v√†o warehouse <code>PostgreSQL</code></li>
<li><strong>Visualization</strong>: S·ª≠ d·ª•ng <code>Streamlit</code> ƒë·ªÉ l√†m Dashboard</li>
</ol>
<h2 id="set-up" class="headerLink">
    <a href="#set-up" class="header-mark"></a>Set up</h2><p>B·∫Øt ƒë·∫ßu v·ªõi <code>Docker</code>, ta s·∫Ω x√¢y d·ª±ng l·∫ßn l∆∞·ª£t t·ª´ng image b·∫±ng c√°ch vi·∫øt <code>docker-compose.yml</code></p>
<div class="details admonition Tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw"></i>Tip nho nh·ªè<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>H√£y <sup>pull</sup>/<sub>build</sub> l·∫ßn l∆∞·ª£t t·ª´ng lo·∫°i framework l·∫ßn l∆∞·ª£t ƒë·ªÉ ch·∫Øc ch·∫Øn r·∫±ng ch√∫ng ho·∫°t ƒë·ªông tr∆°n tru nh·∫•t tr∆∞·ªõc</p>
<p>Ho·∫∑c b·∫°n c≈©ng c√≥ th·ªÉ xem lu√¥n ph·∫ßn ho√†n ch·ªânh <a href="#ho%c3%a0n-ch%e1%bb%89nh-setup" rel="">Ho√†n ch·ªânh set up</a></p>
</div>
        </div>
    </div>
<h3 id="minio" class="headerLink">
    <a href="#minio" class="header-mark"></a>MinIO</h3><p>MinIO l√† m·ªôt server l∆∞u tr·ªØ ƒë·ªëi t∆∞·ª£ng d·∫°ng ph√¢n t√°n v·ªõi hi·ªáu nƒÉng cao v√† cung c·∫•p c√°c api gi·ªëng v·ªõi <code>Amazon S3</code>, ta c√≥ th·ªÉ upload, download file,&hellip; m·ªôt c√°ch ƒë∆°n gi·∫£n.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="w">  </span><span class="nt">minio</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l">minio</span><span class="w">
</span><span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">minio/minio</span><span class="w">
</span><span class="w">      </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">minio</span><span class="w">
</span><span class="w">      </span><span class="nt">volumes</span><span class="p">:</span><span class="w"> 
</span><span class="w">        </span>- <span class="l">./MinIO/storage:/data</span><span class="w">
</span><span class="w">        </span>- <span class="l">./MinIO/config:/root/.minio</span><span class="w">
</span><span class="w">      </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="s2">&#34;9000:9000&#34;</span><span class="w">
</span><span class="w">        </span>- <span class="s2">&#34;9090:9090&#34;</span><span class="w">
</span><span class="w">      </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="l">./.env</span><span class="w">
</span><span class="w">      </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l">server /data --console-address &#34;:9090&#34;</span><span class="w">
</span><span class="w">      </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="l">de_network</span><span class="w">
</span><span class="w">    </span><span class="nt">mc</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">minio/mc</span><span class="w">
</span><span class="w">      </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">mc</span><span class="w">
</span><span class="w">      </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l">mc</span><span class="w">
</span><span class="w">      </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="l">./.env</span><span class="w">
</span><span class="w">      </span><span class="nt">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="p">&gt;</span><span class="sd">
</span><span class="sd">            </span><span class="w">            </span><span class="l">/bin/sh -c &#34; until (/usr/bin/mc config host add minio http://minio:9000 minio minio123) do echo &#39;...waiting...&#39; &amp;&amp; sleep 1;done; /usr/bin/mc mb minio/warehouse; /usr/bin/mc policy set public minio/warehouse; exit 0; &#34;</span><span class="w">
</span><span class="w">      </span><span class="nt">depends_on</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="l">minio</span><span class="w">
</span><span class="w">      </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="l">de_network</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw"></i>Note<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">V·ªÅ <code>.env</code> file, ƒë√¢y l√† file ch·ª©a th√¥ng tin c√°c bi·∫øn m√¥i tr∆∞·ªùng thi·∫øt l·∫≠p cho t·ª´ng image, m√¨nh s·∫Ω n√≥i sau</div>
        </div>
    </div>
<h3 id="mysql" class="headerLink">
    <a href="#mysql" class="header-mark"></a>MySQL</h3><p>MySQL l√† m·ªôt trong s·ªë c√°c ph·∫ßn m·ªÅm RDBMS (Relational DataBase Management Systems) ph·ªï bi·∫øn nh·∫•t, ta s·∫Ω s·ª≠ d·ª•ng database n√†y ƒë·ªÉ l∆∞u raw data m√¥ ph·ªèng cho source data c·∫ßn ingest</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="w">  </span><span class="nt">de_mysql</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mysql:8.0</span><span class="w">
</span><span class="w">      </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">de_mysql</span><span class="w">
</span><span class="w">      </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="s2">&#34;3306:3306&#34;</span><span class="w">
</span><span class="w">      </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="l">./storage/mysql_data:/var/lib/mysql</span><span class="w">
</span><span class="w">        </span>- <span class="l">./dataset:/tmp/dataset</span><span class="w">
</span><span class="w">      </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="l">./.env</span><span class="w">
</span><span class="w">      </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">        </span>- <span class="l">de_network</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h3 id="postgesql" class="headerLink">
    <a href="#postgesql" class="header-mark"></a>PostgeSQL</h3><p>PostgreSQL l√† m·ªôt h·ªá th·ªëng qu·∫£n tr·ªã c∆° s·ªü d·ªØ li·ªáu quan h·ªá-ƒë·ªëi t∆∞·ª£ng (object-relational database management system), v√† ta s·∫Ω dung n√≥ l√†m data warehouse cho project l·∫ßn n√†y.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="w">  </span><span class="nt">de_psql</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">de_psql</span><span class="w">
</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">postgres:15-alpine</span><span class="w">
</span><span class="w">    </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">./.env</span><span class="w">
</span><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="s1">&#39;5432:5432&#39;</span><span class="w">
</span><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w"> 
</span><span class="w">      </span>- <span class="l">./storage/postgres_data:/var/lib/postgresql/data</span><span class="w">
</span><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">de_network    </span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h3 id="dagster" class="headerLink">
    <a href="#dagster" class="header-mark"></a>Dagster</h3><p>Dagster l√† m·ªôt c√¥ng c·ª• m√£ ngu·ªìn m·ªü h·ªó tr·ª£ Orchestrate Task (qu·∫£n l√Ω, t·ªï ch·ª©c, ƒëi·ªÅu ph·ªëi c√°c t√°c v·ª• v√† c√¥ng vi·ªác), h·ªó tr·ª£ gi√∫p x√¢y d·ª±ng <code>data pipeline</code> kh√° t·ªët. M√¨nh th·∫•y c√¥ng c·ª• n√†y g·ªçn nh·∫π h∆°n <code>Apache Airflow</code> v√† c≈©ng ƒë∆°n gi·∫£n h∆°n.</p>
<p>ƒê·∫ßu ti√™n h√£y vi·∫øt trong <code>docker-compose.yml</code> v·ªÅ dagster nh∆∞ sau:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="w">  </span><span class="nt">de_dagster</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l">./dagster/</span><span class="w">
</span><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">de_dagster</span><span class="w">
</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">de_dagster</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>ƒê·ªëi v·ªõi Dagster, ta s·∫Ω t·ª± config b·∫±ng <code>Dockerfile</code>, h√£y t·∫°o 1 folder <code>./dagster/</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash">mkdir dagster
<span class="nb">cd</span> dagster
touch Dockerfile requirements.txt
</code></pre></td></tr></table>
</div>
</div><p>Sau ƒë√≥ t·∫°o <code>Dockerfile</code> c√≥ n·ªôi dung sau:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Dockerfile" data-lang="Dockerfile"><span class="c"># Dagster libraries to run both dagit and the dagster-daemon. Does not</span><span class="err">
</span><span class="err"></span><span class="c"># need to have access to any pipeline code.</span><span class="err">
</span><span class="err"></span><span class="k">FROM</span><span class="s"> python:3.10-slim</span><span class="err">
</span><span class="err"></span><span class="c"># Set $DAGSTER_HOME and copy dagster instance and workspace YAML there</span><span class="err">
</span><span class="err"></span><span class="k">ENV</span> <span class="nv">DAGSTER_HOME</span><span class="o">=</span>/opt/dagster/dagster_home<span class="err">
</span><span class="err"></span><span class="k">RUN</span> mkdir -p <span class="nv">$DAGSTER_HOME</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    mkdir -p <span class="nv">$DAGSTER_HOME</span>/storage <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    mkdir -p <span class="nv">$DAGSTER_HOME</span>/compute_logs <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    mkdir -p <span class="nv">$DAGSTER_HOME</span>/local_artifact_storage<span class="err">
</span><span class="err"></span><span class="k">WORKDIR</span><span class="s"> $DAGSTER_HOME</span><span class="err">
</span><span class="err"></span><span class="k">COPY</span> requirements.txt <span class="nv">$DAGSTER_HOME</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> pip install --upgrade pip <span class="o">&amp;&amp;</span> pip install -r requirements.txt<span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>v√† <code>requirement.txt</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">dagster==1.1.20
dagit==1.1.20
dagster-postgres==0.17.20
dagster-dbt==0.17.20
</code></pre></td></tr></table>
</div>
</div><h4 id="dagit" class="headerLink">
    <a href="#dagit" class="header-mark"></a>Dagit</h4><p>Dagit l√† giao di·ªán UI c·ªßa Dagster, v√† ta s·∫Ω thao t√°c tr√™n Dagit ƒë·ªÉ qu·∫£n l√Ω c√°c assets, jobs,&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="w">  </span><span class="nt">de_dagster_dagit</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">de_dagster:latest</span><span class="w">
</span><span class="w">    </span><span class="nt">entrypoint</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">dagit</span><span class="w">
</span><span class="w">      </span>- -<span class="l">h</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;0.0.0.0&#34;</span><span class="w">
</span><span class="w">      </span>- -<span class="l">p</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;3001&#34;</span><span class="w">
</span><span class="w">      </span>- -<span class="l">w</span><span class="w">
</span><span class="w">      </span>- <span class="l">workspace.yaml</span><span class="w">
</span><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">de_dagster_dagit</span><span class="w">
</span><span class="w">    </span><span class="nt">expose</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;3001&#34;</span><span class="w">
</span><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;3001:3001&#34;</span><span class="w">
</span><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w"> </span><span class="c"># Make docker client accessible so we can terminate containers from dagit</span><span class="w">
</span><span class="w">      </span>- <span class="l">/var/run/docker.sock:/var/run/docker.sock</span><span class="w">
</span><span class="w">      </span>- <span class="l">./dagster_home:/opt/dagster/dagster_home</span><span class="w">
</span><span class="w">    </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">./.env</span><span class="w">
</span><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">de_network</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>Sau ƒë√≥ h√£y t·∫°o 1 folder <code>./dagster_home</code>, trong ƒë√≥ t·∫°o 2 file config cho workspace c·ªßa dagster:
<code>dagster.yaml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="nt">run_coordinator</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l">dagster.core.run_coordinator</span><span class="w">
</span><span class="w">  </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l">QueuedRunCoordinator</span><span class="w">
</span><span class="w">  </span><span class="nt">config</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">max_concurrent_runs</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="nt">scheduler</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l">dagster.core.scheduler</span><span class="w">
</span><span class="w">  </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l">DagsterDaemonScheduler</span><span class="w">
</span><span class="w">  </span><span class="nt">config</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">max_catchup_runs</span><span class="p">:</span><span class="w"> </span><span class="m">5</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="nt">storage</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">postgres</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">postgres_db</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">username</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="l">DAGSTER_PG_USERNAME</span><span class="w">
</span><span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="l">DAGSTER_PG_PASSWORD</span><span class="w">
</span><span class="w">      </span><span class="nt">hostname</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="l">DAGSTER_PG_HOSTNAME</span><span class="w">
</span><span class="w">      </span><span class="nt">db_name</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="l">DAGSTER_PG_DB</span><span class="w">
</span><span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">5432</span><span class="w">
</span><span class="w"></span><span class="nt">run_launcher</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l">dagster.core.launcher</span><span class="w">
</span><span class="w">  </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l">DefaultRunLauncher</span><span class="w">
</span><span class="w"></span><span class="nt">compute_logs</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l">dagster.core.storage.local_compute_log_manager</span><span class="w">
</span><span class="w">  </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l">LocalComputeLogManager</span><span class="w">
</span><span class="w">  </span><span class="nt">config</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">base_dir</span><span class="p">:</span><span class="w"> </span><span class="l">/opt/dagster/dagster_home/compute_logs</span><span class="w">
</span><span class="w"></span><span class="nt">local_artifact_storage</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l">dagster.core.storage.root</span><span class="w">
</span><span class="w">  </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l">LocalArtifactStorage</span><span class="w">
</span><span class="w">  </span><span class="nt">config</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">base_dir</span><span class="p">:</span><span class="w"> </span><span class="l">/opt/dagster/dagster_home/local_artifact_storage</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>v√† <code>workspace.yaml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="nt">load_from</span><span class="p">:</span><span class="w">
</span><span class="w">  </span>- <span class="nt">grpc_server</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l">etl_pipeline</span><span class="w">
</span><span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">4000</span><span class="w">
</span><span class="w">      </span><span class="nt">location_name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;etl_pipeline&#34;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h4 id="dagster-deamon" class="headerLink">
    <a href="#dagster-deamon" class="header-mark"></a>Dagster Deamon</h4><p>ƒê·ªÉ qu·∫£n l√Ω c√°c Schedules, sensors,&hellip; ta c·∫ßn ph·∫£i c√≥ <code>dagster-deamon</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="w">  </span><span class="nt">de_dagster_daemon</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">de_dagster:latest</span><span class="w">
</span><span class="w">    </span><span class="nt">entrypoint</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">dagster-daemon</span><span class="w">
</span><span class="w">      </span>- <span class="l">run</span><span class="w">
</span><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">de_dagster_daemon</span><span class="w">
</span><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w"> </span><span class="c"># Make docker client accessible so we can launch containers using host docker</span><span class="w">
</span><span class="w">      </span>- <span class="l">/var/run/docker.sock:/var/run/docker.sock</span><span class="w">
</span><span class="w">      </span>- <span class="l">./dagster_home:/opt/dagster/dagster_home</span><span class="w">
</span><span class="w">    </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">./.env</span><span class="w">
</span><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">de_network</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h3 id="pipeline" class="headerLink">
    <a href="#pipeline" class="header-mark"></a>Pipeline</h3><p>T·∫•t c·∫£ m·ªçi vi·ªác x√¢y d·ª±ng pipeline ta s·∫Ω ho·∫°t ƒë·ªông ·ªü ƒë√¢y</p>
<p>ƒê·∫ßu ti√™n ta c·∫ßn init m·ªôt dagster project</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">dagster project scaffold --name etl_pipeline
</code></pre></td></tr></table>
</div>
</div><p>v√† th∆∞ m·ª•c m·ªõi t·∫°o s·∫Ω tr√¥ng nh∆∞ th·∫ø n√†y:
<figure><a class="lightgallery" href="/img/projects-tree.png" title="tree" data-thumbnail="/img/projects-tree.png">
        <img
            
            loading="lazy"
            src="/img/projects-tree.png"
            srcset="/img/projects-tree.png, /img/projects-tree.png 1.5x, /img/projects-tree.png 2x"
            sizes="auto"
            alt="tree" height="213"  width="339" >
    </a></figure></p>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>Tip<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>ƒê·ªÉ ch·∫°y ƒë∆∞·ª£c l·ªánh dagster ·ªü b∆∞·ªõc t·∫°o dagster project, ta c·∫ßn ph·∫£i c√≥ <code>dagster package</code>, n·∫øu ch∆∞a c√≥ h√£y c√†i ƒë·∫∑t b·∫±ng: <code>pip install dagster</code></p>
<p>&ndash;&gt; N√™n c√†i ƒë·∫∑t trong m√¥i tr∆∞·ªùng ·∫£o</p>
</div>
        </div>
    </div>
<p>Sau ƒë√≥ v√†o th∆∞ m·ª•c v·ª´a t·∫°o v√†o vi·∫øt <code>Dockerfile</code> th√¥i:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Dockerfile" data-lang="Dockerfile"><span class="k">FROM</span><span class="s"> python:3.10-slim</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># Add repository code</span><span class="err">
</span><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /opt/dagster/app</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">COPY</span> requirements.txt /opt/dagster/app<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> pip install --upgrade pip <span class="o">&amp;&amp;</span> pip install -r requirements.txt<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /opt/dagster/app</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">COPY</span> . /opt/dagster/app/etl_pipeline<span class="err">
</span><span class="err"></span><span class="c"># CMD allows this to be overridden from run launchers or executors that want to run other commands against your repository</span><span class="err">
</span><span class="err"></span><span class="k">CMD</span> <span class="p">[</span><span class="s2">&#34;dagster&#34;</span><span class="p">,</span> <span class="s2">&#34;api&#34;</span><span class="p">,</span> <span class="s2">&#34;grpc&#34;</span><span class="p">,</span> <span class="s2">&#34;-h&#34;</span><span class="p">,</span> <span class="s2">&#34;0.0.0.0&#34;</span><span class="p">,</span> <span class="s2">&#34;-p&#34;</span><span class="p">,</span> <span class="s2">&#34;4000&#34;</span><span class="p">,</span> <span class="s2">&#34;-m&#34;</span><span class="p">,</span> <span class="s2">&#34;etl_pipeline&#34;</span><span class="p">]</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>c√πng v·ªõi <code>requirements.txt</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">dagster==1.1.20
dagit==1.1.20
dagster-postgres==0.17.20
dagster-aws==0.17.20
dagster-dbt==0.17.20
pandas==1.5.3
SQLAlchemy==1.4.46
pymysql==1.0.2
cryptography==39.0.0
pyarrow==10.0.1
boto3==1.26.57
fsspec==2023.1.0
s3fs==0.4.2
minio==7.1.13
</code></pre></td></tr></table>
</div>
</div><p>Cu·ªëi c√πng l√† vi·∫øt v√†o <code>docker-compose.yml</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="w">  </span><span class="nt">etl_pipeline</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l">./etl_pipeline</span><span class="w">
</span><span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l">./Dockerfile</span><span class="w">
</span><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">etl_pipeline</span><span class="w">
</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">etl_pipeline:latest</span><span class="w">
</span><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">./etl_pipeline:/opt/dagster/app</span><span class="w">
</span><span class="w">    </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">./.env</span><span class="w">
</span><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">de_network</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h3 id="streamlit" class="headerLink">
    <a href="#streamlit" class="header-mark"></a>Streamlit</h3><p>Cu·ªëi c√πng l√† vi·ªác l√† Dashboard, Streamlit ch·∫Øc ch·∫Øc l√† c√¥ng c·ª• si√™u ph√π h·ª£p l√†m vi·ªác n√†y. ƒê√¢y l√† framework h·ªó tr·ª£ vi·ªác x√¢y d·ª±ng giao di·ªán ∆∞u nh√¨n ch·ªâ b·∫±ng Python, qu√° ƒë√£ ph·∫£i kh√¥ng n√†o :))</p>
<p>H√£y t·∫°o folder <code>./streamlit/scr/</code> c√πng v·ªõi  <code>./streamlit/Dockerfile</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Dockerfile" data-lang="Dockerfile"><span class="k">FROM</span><span class="s"> python:3.10</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">EXPOSE</span><span class="s"> 8501</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /usr/src/app</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">COPY</span> requirements.txt ./<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> pip install -r requirements.txt<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">COPY</span> . .<span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>v√† <code>streamlit/requirements.txt</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">pandas
plotly
matplotlib
numpy
streamlit
psycopg2-binary
sqlalchemy
python-dotenv
</code></pre></td></tr></table>
</div>
</div><p>Cu·ªëi c√πng l√† ghi trong yml</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="w">  </span><span class="nt">streamlit</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l">./streamyml</span><span class="w">
</span><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">streamlit</span><span class="w">
</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">streamlit:latest</span><span class="w">
</span><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;streamlit run src/main.py&#34;</span><span class="w">
</span><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;8501:8501&#34;</span><span class="w">
</span><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;./streamlit/src:/usr/src/app/src&#34;</span><span class="w">
</span><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">de_network</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h3 id="ho√†n-ch·ªânh-setup" class="headerLink">
    <a href="#ho%c3%a0n-ch%e1%bb%89nh-setup" class="header-mark"></a>Ho√†n ch·ªânh setup</h3><p>Cu·ªëi c√πng, file yaml s·∫Ω tr√¥ng nh∆∞ th·∫ø n√†y:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="c"># version: &#39;3.9&#39;</span><span class="w">
</span><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">minio</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l">minio</span><span class="w">
</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">minio/minio</span><span class="w">
</span><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">minio</span><span class="w">
</span><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w"> 
</span><span class="w">      </span>- <span class="l">./MinIO/storage:/data</span><span class="w">
</span><span class="w">      </span>- <span class="l">./MinIO/config:/root/.minio</span><span class="w">
</span><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;9000:9000&#34;</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;9090:9090&#34;</span><span class="w">
</span><span class="w">    </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">./.env</span><span class="w">
</span><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l">server /data --console-address &#34;:9090&#34;</span><span class="w">
</span><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">de_network</span><span class="w">
</span><span class="w">  </span><span class="nt">mc</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">minio/mc</span><span class="w">
</span><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">mc</span><span class="w">
</span><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l">mc</span><span class="w">
</span><span class="w">    </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">./.env</span><span class="w">
</span><span class="w">    </span><span class="nt">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="p">&gt;</span><span class="sd">
</span><span class="sd">          </span><span class="w">          </span><span class="l">/bin/sh -c &#34; until (/usr/bin/mc config host add minio http://minio:9000 minio minio123) do echo &#39;...waiting...&#39; &amp;&amp; sleep 1;done; /usr/bin/mc mb minio/warehouse; /usr/bin/mc policy set public minio/warehouse; exit 0; &#34;</span><span class="w">
</span><span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">minio</span><span class="w">
</span><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">de_network</span><span class="w">
</span><span class="w">
</span><span class="w">  </span><span class="nt">de_mysql</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mysql:8.0</span><span class="w">
</span><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">de_mysql</span><span class="w">
</span><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;3306:3306&#34;</span><span class="w">
</span><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">./storage/mysql_data:/var/lib/mysql</span><span class="w">
</span><span class="w">      </span>- <span class="l">./dataset:/tmp/dataset</span><span class="w">
</span><span class="w">    </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">./.env</span><span class="w">
</span><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">de_network</span><span class="w">
</span><span class="w">
</span><span class="w">  </span><span class="nt">de_psql</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">de_psql</span><span class="w">
</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">postgres:15-alpine</span><span class="w">
</span><span class="w">    </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">./.env</span><span class="w">
</span><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="s1">&#39;5432:5432&#39;</span><span class="w">
</span><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w"> 
</span><span class="w">      </span>- <span class="l">./storage/postgres_data:/var/lib/postgresql/data</span><span class="w">
</span><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">de_network</span><span class="w">
</span><span class="w">    
</span><span class="w">  </span><span class="nt">streamlit</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l">./streamlit</span><span class="w">
</span><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">streamlit</span><span class="w">
</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">streamlit:latest</span><span class="w">
</span><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;streamlit run src/main.py&#34;</span><span class="w">
</span><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;8501:8501&#34;</span><span class="w">
</span><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;./streamlit/src:/usr/src/app/src&#34;</span><span class="w">
</span><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">de_network</span><span class="w">
</span><span class="w">
</span><span class="w">  </span><span class="nt">de_dagster</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l">./dagster/</span><span class="w">
</span><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">de_dagster</span><span class="w">
</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">de_dagster</span><span class="w">
</span><span class="w">
</span><span class="w">  </span><span class="nt">de_dagster_dagit</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">de_dagster:latest</span><span class="w">
</span><span class="w">    </span><span class="nt">entrypoint</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">dagit</span><span class="w">
</span><span class="w">      </span>- -<span class="l">h</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;0.0.0.0&#34;</span><span class="w">
</span><span class="w">      </span>- -<span class="l">p</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;3001&#34;</span><span class="w">
</span><span class="w">      </span>- -<span class="l">w</span><span class="w">
</span><span class="w">      </span>- <span class="l">workspace.yaml</span><span class="w">
</span><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">de_dagster_dagit</span><span class="w">
</span><span class="w">    </span><span class="nt">expose</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;3001&#34;</span><span class="w">
</span><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;3001:3001&#34;</span><span class="w">
</span><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w"> </span><span class="c"># Make docker client accessible so we can terminate containers from dagit</span><span class="w">
</span><span class="w">      </span>- <span class="l">/var/run/docker.sock:/var/run/docker.sock</span><span class="w">
</span><span class="w">      </span>- <span class="l">./dagster_home:/opt/dagster/dagster_home</span><span class="w">
</span><span class="w">    </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">./.env</span><span class="w">
</span><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">de_network</span><span class="w">
</span><span class="w">
</span><span class="w">  </span><span class="nt">de_dagster_daemon</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">de_dagster:latest</span><span class="w">
</span><span class="w">    </span><span class="nt">entrypoint</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">dagster-daemon</span><span class="w">
</span><span class="w">      </span>- <span class="l">run</span><span class="w">
</span><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">de_dagster_daemon</span><span class="w">
</span><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w"> </span><span class="c"># Make docker client accessible so we can launch containers using host docker</span><span class="w">
</span><span class="w">      </span>- <span class="l">/var/run/docker.sock:/var/run/docker.sock</span><span class="w">
</span><span class="w">      </span>- <span class="l">./dagster_home:/opt/dagster/dagster_home</span><span class="w">
</span><span class="w">    </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">./.env</span><span class="w">
</span><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">de_network</span><span class="w">
</span><span class="w">    
</span><span class="w">  </span><span class="c"># Pipelines</span><span class="w">
</span><span class="w">  </span><span class="nt">etl_pipeline</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l">./etl_pipeline</span><span class="w">
</span><span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l">./Dockerfile</span><span class="w">
</span><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">etl_pipeline</span><span class="w">
</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">etl_pipeline:latest</span><span class="w">
</span><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">./etl_pipeline:/opt/dagster/app</span><span class="w">
</span><span class="w">    </span><span class="nt">env_file</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">./.env</span><span class="w">
</span><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="l">de_network</span><span class="w">
</span><span class="w">  
</span><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">de_network</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l">bridge</span><span class="w">
</span><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">de_network</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>V√† <code>.env</code> file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"># PostgreSQL
POSTGRES_HOST=de_psql
POSTGRES_PORT=5432
POSTGRES_DB=football
POSTGRES_USER=admin
POSTGRES_PASSWORD=admin123
POSTGRES_HOST_AUTH_METHOD=trust

# Dagster
DAGSTER_PG_HOSTNAME=de_psql
DAGSTER_PG_USERNAME=admin
DAGSTER_PG_PASSWORD=admin123
DAGSTER_PG_DB=football

# MySQL
MYSQL_HOST=de_mysql
MYSQL_PORT=3306
MYSQL_DATABASE=football
MYSQL_ROOT_PASSWORD=admin123
MYSQL_USER=admin
MYSQL_PASSWORD=admin123

# MinIO
MINIO_ENDPOINT=minio:9000
MINIO_ROOT_USER=minio
MINIO_ROOT_PASSWORD=minio123
MINIO_ACCESS_KEY=minio
MINIO_SECRET_KEY=minio123
DATALAKE_BUCKET=warehouse
AWS_ACCESS_KEY_ID=minio
AWS_SECRET_ACCESS_KEY=minio123
AWS_REGION=us-east-1
</code></pre></td></tr></table>
</div>
</div><div class="details admonition warning open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-exclamation-triangle fa-fw"></i>Warning<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">N·∫øu b·∫°n ch·ªâ ƒë·ªçc ph·∫ßn <a href="#ho%c3%a0n-ch%e1%bb%89nh-setup" rel="">Ho√†n ch·ªânh setup</a> th√¨ c√≥ th·ªÉ h·ªá th·ªëng v·ªÖ s·∫Ω g·∫∑p l·ªói v√¨ c√≥ th·ªÉ thi·∫øu c√°c configuration c·∫ßn thi·∫øt cho <code>dagster</code>, <code>dagit</code> hay <code>pipeline</code>. B·∫°n c·∫ßn ƒë·ªçc qua ph·∫ßn <a href="#dagster" rel="">Dagster</a>, <a href="#dagit" rel="">Dagit</a>, <a href="#pipeline" rel="">Pipeline</a></div>
        </div>
    </div>
<p><strong>Ch·∫°y th·ª≠</strong>: sau khi ho√†n t·∫•t to√†n b·ªô set up d√†i ngo·∫±n, c≈©ng ƒë√£ ƒë·∫øn l√∫c ch·∫°y ch∆∞∆°ng tr√¨nh th√¥i.</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw"></i>Note nho nh·ªè<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">N·∫øu b·∫°n ƒë√£ build l·∫ßn l∆∞·ª£t c√°c images r·ªìi, th√¨ ch·ªâ c·∫ßn compose up th√¥i, n·∫øu kh√¥ng, h√£y build b·∫±ng l·ªánh <code>docker compose build</code> tr∆∞·ªõc khi ch·∫°y compose up.</div>
        </div>
    </div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">docker compose --env-file .env up -d
</code></pre></td></tr></table>
</div>
</div><div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>L·∫°i l√† m·ªôt tip c√≥ th·ªÉ h·ªØu √≠ch<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>ƒê·ªÉ ƒë∆°n gi·∫£n h√≥a vi·ªác ghi l·ªánh d√†i d√≤ng, h√£y t·∫°o m·ªôt make file t√™n <code>Makefile</code> v·ªõi n·ªôi dung sau:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Makefile" data-lang="Makefile"><span class="err">include</span> <span class="err">.env</span>

<span class="nf">build</span><span class="o">:</span>
	docker compose build

<span class="nf">up</span><span class="o">:</span>
	docker compose --env-file .env up -d

<span class="nf">down</span><span class="o">:</span>
	docker compose --env-file .env down

<span class="nf">restart</span><span class="o">:</span>
	make down <span class="o">&amp;&amp;</span> make up

<span class="nf">to_psql</span><span class="o">:</span>
	docker <span class="nb">exec</span> -ti de_psql psql postgres://<span class="si">${</span><span class="nv">POSTGRES_USER</span><span class="si">}</span>:<span class="si">${</span><span class="nv">POSTGRES_PASSWORD</span><span class="si">}</span>@<span class="si">${</span><span class="nv">POSTGRES_HOST</span><span class="si">}</span>:<span class="si">${</span><span class="nv">POSTGRES_PORT</span><span class="si">}</span>/<span class="si">${</span><span class="nv">POSTGRES_DB</span><span class="si">}</span>

<span class="nf">psql_create</span><span class="o">:</span>
	docker <span class="nb">exec</span> -ti de_psql psql postgres://<span class="si">${</span><span class="nv">POSTGRES_USER</span><span class="si">}</span>:<span class="si">${</span><span class="nv">POSTGRES_PASSWORD</span><span class="si">}</span>@<span class="si">${</span><span class="nv">POSTGRES_HOST</span><span class="si">}</span>:<span class="si">${</span><span class="nv">POSTGRES_PORT</span><span class="si">}</span>/<span class="si">${</span><span class="nv">POSTGRES_DB</span><span class="si">}</span> -f /tmp/psql_schema.sql

<span class="nf">to_mysql</span><span class="o">:</span>
	docker <span class="nb">exec</span> -it de_mysql mysql --local-infile<span class="o">=</span><span class="m">1</span> -u<span class="s2">&#34;</span><span class="si">${</span><span class="nv">MYSQL_USER</span><span class="si">}</span><span class="s2">&#34;</span> -p<span class="s2">&#34;</span><span class="si">${</span><span class="nv">MYSQL_PASSWORD</span><span class="si">}</span><span class="s2">&#34;</span> <span class="si">${</span><span class="nv">MYSQL_DATABASE</span><span class="si">}</span>

<span class="nf">to_mysql_root</span><span class="o">:</span>
	docker <span class="nb">exec</span> -it de_mysql mysql -u<span class="s2">&#34;root&#34;</span> -p<span class="s2">&#34;</span><span class="si">${</span><span class="nv">MYSQL_ROOT_PASSWORD</span><span class="si">}</span><span class="s2">&#34;</span> <span class="si">${</span><span class="nv">MYSQL_DATABASE</span><span class="si">}</span>

<span class="nf">mysql_load</span><span class="o">:</span>
	docker <span class="nb">exec</span> -it de_mysql mysql --local_infile -u<span class="s2">&#34;</span><span class="si">${</span><span class="nv">MYSQL_USER</span><span class="si">}</span><span class="s2">&#34;</span> -p<span class="s2">&#34;</span><span class="si">${</span><span class="nv">MYSQL_PASSWORD</span><span class="si">}</span><span class="s2">&#34;</span> <span class="si">${</span><span class="nv">MYSQL_DATABASE</span><span class="si">}</span> -e<span class="s2">&#34;source /tmp/dataset/load_data/load_mysql_data.sql&#34;</span>

<span class="nf">mysql_create</span><span class="o">:</span>
	docker <span class="nb">exec</span> -it de_mysql mysql --local_infile -u<span class="s2">&#34;</span><span class="si">${</span><span class="nv">MYSQL_USER</span><span class="si">}</span><span class="s2">&#34;</span> -p<span class="s2">&#34;</span><span class="si">${</span><span class="nv">MYSQL_PASSWORD</span><span class="si">}</span><span class="s2">&#34;</span> <span class="si">${</span><span class="nv">MYSQL_DATABASE</span><span class="si">}</span> -e<span class="s2">&#34;source /tmp/dataset/load_data/mysql_schema.sql&#34;</span>

<span class="nf">mysql_create_relation</span><span class="o">:</span>
	docker <span class="nb">exec</span> -it de_mysql mysql --local_infile -u<span class="s2">&#34;</span><span class="si">${</span><span class="nv">MYSQL_USER</span><span class="si">}</span><span class="s2">&#34;</span> -p<span class="s2">&#34;</span><span class="si">${</span><span class="nv">MYSQL_PASSWORD</span><span class="si">}</span><span class="s2">&#34;</span> <span class="si">${</span><span class="nv">MYSQL_DATABASE</span><span class="si">}</span> -e<span class="s2">&#34;source /tmp/dataset/load_data/mysql_foreign.sql&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>Sau ƒë√≥ ch·ªâ c·∫ßn <code>make up</code> ·ªü terminal l√† xong. N√≥ ho·∫°t ƒë·ªông nh∆∞ alias v·∫≠y.</p>
</div>
        </div>
    </div>
<h2 id="to-be-continue" class="headerLink">
    <a href="#to-be-continue" class="header-mark"></a>To be Continue</h2><p>B√†i ƒë·∫øn ƒë√¢y c≈©ng qu√° l√† d√†i r·ªìi, m√¨nh s·∫Ω vi·∫øt ti·∫øp ·ªü ph·∫ßn 2 :)))</p>
<p>Ch√∫c b·∫°n m·ªôt ng√†y t·ªët l√†nh</p>
<p><strong>-Mew-</strong></p>
<hr>
<h1 id="related" class="headerLink">
    <a href="#related" class="header-mark"></a>Related</h1>
<div class="showcase-box column-2">
    <div class="showcase-image">
        <a href=/stock_analysis/><img
        
        loading="lazy"
        src="/img/projects-stock.jpg"
        srcset="/img/projects-stock.jpg, /img/projects-stock.jpg 1.5x, /img/projects-stock.jpg 2x"
        sizes="auto"
        alt="Stock Analysis"
        title="Stock Analysis" height="200"   width="400" ></a>
    </div>
    <h2 class="showcase-title">
        <a href=/stock_analysis/>Stock Analysis</a>
    </h2>
    <p class="showcase-summary">
        Basic Analyzing VN30 stock using PCA and K-Means
    </p>
    <a class="showcase-link" href=/stock_analysis/>
        Read more...
    </a>
</div>

<div class="showcase-box column-2">
    <div class="showcase-image">
        <a href=/spotify_analysis/><img
        
        loading="lazy"
        src="/img/project-spotify.jpg"
        srcset="/img/project-spotify.jpg, /img/project-spotify.jpg 1.5x, /img/project-spotify.jpg 2x"
        sizes="auto"
        alt="Spotify Analysis"
        title="Spotify Analysis" height="200"   width="400" ></a>
    </div>
    <h2 class="showcase-title">
        <a href=/spotify_analysis/>Spotify Analysis</a>
    </h2>
    <p class="showcase-summary">
        Analyze data from Spotify platform utilizing the Spotify API and MongoDB, Apache Hadoop, Pyspark, Dremio and Power BI
    </p>
    <a class="showcase-link" href=/spotify_analysis/>
        Read more...
    </a>
</div></div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 31 Jul 2023</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share"><button title="Share on Facebook" data-sharer="facebook" data-url="https://phonghuynh.netlify.app/football_etl/" data-hashtag="data engineer"><span class="fab fa-facebook-square fa-fw"></span></button><button title="Share on Linkedin" data-sharer="linkedin" data-url="https://phonghuynh.netlify.app/football_etl/"><span class="fab fa-linkedin fa-fw"></span></button></div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/data-engineer/">data engineer</a>,&nbsp;<a href="/tags/etl/">etl</a>,&nbsp;<a href="/tags/dagster/">dagster</a>,&nbsp;<a href="/tags/docker/">docker</a>,&nbsp;<a href="/tags/tech/">Tech</a>,&nbsp;<a href="/tags/data-pipeline/">data pipeline</a>,&nbsp;<a href="/tags/streamlit/">streamlit</a>,&nbsp;<a href="/tags/mysql/">MySQL</a>,&nbsp;<a href="/tags/postgresql/">PostgreSQL</a>,&nbsp;<a href="/tags/minio/">MinIO</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav">
            <a href="/football_etl_2/" class="next" rel="next" title="Football ETL Analysis P2">Football ETL Analysis P2<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2023 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank" rel="noopener noreferrer">OG</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div></footer></div>

    <div id="fixed-buttons"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="Back to Top">
            <i class="fas fa-arrow-up fa-fw"></i>
        </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
            <i class="fas fa-comment fa-fw"></i>
        </a>
    </div><div class="assets"><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/katex/copy-tex.min.css">
        <noscript><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"></noscript><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/index.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"No results found","snippetLength":30,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"sharerjs":true,"table":{"sort":true}};</script><script type="text/javascript" src="/lib/tablesort/tablesort.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js" defer></script><script type="text/javascript" src="/lib/katex/auto-render.min.js" defer></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js" defer></script><script type="text/javascript" src="/lib/katex/mhchem.min.js" defer></script><script type="text/javascript" src="/js/katex.min.js" defer></script><script type="text/javascript" src="/js/theme.min.js" defer></script></div>
</body>

</html>